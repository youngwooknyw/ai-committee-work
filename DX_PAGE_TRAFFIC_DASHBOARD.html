<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒí’ˆ ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', 'Segoe UI', sans-serif;
            background: #ffffff;
            padding: 30px;
            color: #1a1a1a;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: #ffffff;
            padding: 30px;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            margin-bottom: 30px;
            text-align: center;
            border: 1px solid #e5e7eb;
        }

        .header h1 {
            color: #1a1a1a;
            font-size: 2.4em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .period {
            color: #6b7280;
            font-size: 1.1em;
        }

        .chart-container {
            background: #ffffff;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            margin-bottom: 30px;
            border: 1px solid #e5e7eb;
        }

        .chart-container h2 {
            color: #1a1a1a;
            font-size: 1.5em;
            margin-bottom: 18px;
            font-weight: 700;
        }

        .chart-wrapper {
            position: relative;
            height: 500px;
            width: 100%;
        }

        .table-container {
            background: #ffffff;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            overflow-x: auto;
            border: 1px solid #e5e7eb;
        }

        .table-container h2 {
            color: #1a1a1a;
            font-size: 1.5em;
            margin-bottom: 18px;
            font-weight: 700;
        }

        .table-card {
            background: #ffffff;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            overflow-x: auto;
            border: 1px solid #e5e7eb;
        }

        .table-card h2 {
            color: #1a1a1a;
            font-size: 1.5em;
            margin-bottom: 18px;
            font-weight: 700;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }

        thead {
            background: #374151;
            color: #ffffff;
        }

        th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #e5e7eb;
            color: #1a1a1a;
        }

        tbody tr {
            transition: background-color 0.2s ease;
        }

        tbody tr:hover {
            background-color: #f3f4f6;
        }

        .rank-badge {
            display: inline-block;
            width: 35px;
            height: 35px;
            line-height: 35px;
            text-align: center;
            border-radius: 50%;
            font-weight: 700;
            color: white;
            background: #374151;
        }

        .rank-badge.gold {
            background: #f59e0b;
        }

        .rank-badge.silver {
            background: #6b7280;
        }

        .rank-badge.bronze {
            background: #d97706;
        }

        .page-path {
            font-family: 'Courier New', monospace;
            color: #1a1a1a;
            font-weight: 600;
            display: block;
            margin-bottom: 5px;
        }

        .page-title {
            font-size: 0.9em;
            color: #1a1a1a;
            display: block;
            margin: 5px 0;
            font-weight: 500;
        }

        .page-url {
            font-size: 0.85em;
            color: #6b7280;
            font-family: 'Courier New', monospace;
            display: block;
            margin-top: 3px;
            word-break: break-all;
        }

        .page-url a {
            color: #2563eb;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .page-url a:hover {
            color: #1d4ed8;
            text-decoration: underline;
        }

        .number {
            font-weight: 600;
            color: #1a1a1a;
        }

        .change-rate {
            font-size: 0.85em;
            font-weight: 500;
            margin-top: 4px;
            display: block;
        }

        .change-rate.positive {
            color: #dc2626;
        }

        .change-rate.negative {
            color: #3b82f6;
        }

        .change-rate.neutral {
            color: #6b7280;
        }

        .metric-value {
            display: block;
        }

        @media (max-width: 768px) {
            table {
                font-size: 0.85em;
            }
            
            th, td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ìƒí’ˆ ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h1>
            <p style="color:#6b7280; font-weight:500;">í˜„ì¬ ì£¼: 2025ë…„ 11ì›” 17ì¼ ~ 11ì›” 23ì¼ | ì „ì£¼: 2025ë…„ 11ì›” 10ì¼ ~ 11ì›” 16ì¼ (BigQuery ë°ì´í„°)</p>
        </div>

        <!-- ì¸ì‚¬ì´íŠ¸ ì„¹ì…˜ ì¶”ê°€ -->
        <div class="table-container" style="margin-bottom: 30px;">
            <h2>ğŸ’¡ ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ë³„ ì„±ê³¼ ìš”ì•½</h2>
            <div id="insightsContainer"></div>
        </div>

        <!-- Top 3 í˜ì´ì§€ë³„ íŠ¹ì§• ë° ê°œì„ ì‚¬í•­ -->
        <div class="table-container" style="margin-top: 30px;">
            <h2>ğŸ† Top 3 í˜ì´ì§€ë³„ íŠ¹ì§• ë° ê°œì„ ì‚¬í•­</h2>
            <p style="color: #6b7280; font-size: 0.9em; margin-bottom: 20px;">
                í˜ì´ì§€ ì¡°íšŒìˆ˜ ê¸°ì¤€ Top 3 í˜ì´ì§€ì˜ í•µì‹¬ ì§€í‘œ, íŠ¹ì§• ë° ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥í•œ ê°œì„ ì‚¬í•­ì…ë‹ˆë‹¤.
            </p>
            <div id="top3PagesAnalysisContainer"></div>
        </div>

        <div class="chart-container">
            <h2>ğŸ“ˆ í˜ì´ì§€ ê²½ë¡œë³„ ì¼ìë³„ í˜ì´ì§€ ì¡°íšŒìˆ˜ ì¶”ì´</h2>
            <div class="chart-wrapper">
                <canvas id="dailyTrendChart"></canvas>
            </div>
        </div>

        <div class="table-card" style="margin-top: 30px;">
            <h2>ğŸ† ìƒí’ˆ ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ ì„±ê³¼ TOP 10</h2>
            <table>
                <thead>
                    <tr>
                        <th>ìˆœìœ„</th>
                        <th>í˜ì´ì§€ ê²½ë¡œ</th>
                        <th>í˜ì´ì§€ ì¡°íšŒìˆ˜</th>
                        <th>êµ¬ë§¤ ì´ë²¤íŠ¸</th>
                        <th>ë§¤ì¶œ (ì›)</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>

        <!-- DXMB í˜ì´ì§€ ìƒí’ˆ Top 5 ì„¹ì…˜ -->
        <div class="table-container" style="margin-top: 30px;">
            <h2>ğŸ›ï¸ ìƒí’ˆ ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ë³„ ìƒí’ˆ ì¡°íšŒ ë° êµ¬ë§¤ Top5</h2>
            <div id="dxmbProductsContainer"></div>
        </div>

    </div>

    <script>
        // ì¼ìë³„ í˜ì´ì§€ ì¡°íšŒìˆ˜ ë°ì´í„° (2025-11-01 ~ 2025-11-23)
        const dailyTrafficData = {
            "dates": [
                "2025-11-01",
                "2025-11-02",
                "2025-11-03",
                "2025-11-04",
                "2025-11-05",
                "2025-11-06",
                "2025-11-07",
                "2025-11-08",
                "2025-11-09",
                "2025-11-10",
                "2025-11-11",
                "2025-11-12",
                "2025-11-13",
                "2025-11-14",
                "2025-11-15",
                "2025-11-16",
                "2025-11-17",
                "2025-11-18",
                "2025-11-19",
                "2025-11-20",
                "2025-11-21",
                "2025-11-22",
                "2025-11-23"
            ],
            "pages": [
                "/display/DXMB01",
                "/display/DXMB01B06",
                "/display/DXMB01B06B02",
                "/display/DXMB01B06B03",
                "/display/DXMB02",
                "/display/DXMB02B06",
                "/display/DXMB02B06B01",
                "/display/DXMB02B06B02",
                "/display/DXMB02B06B03",
                "/display/DXMB02BST"
            ],
            "daily_data": {
                "/display/DXMB01": {
                    "2025-11-01": 1137, "2025-11-02": 1689, "2025-11-03": 2110, "2025-11-04": 1670, "2025-11-05": 1646,
                    "2025-11-06": 1777, "2025-11-07": 1570, "2025-11-08": 965, "2025-11-09": 1170, "2025-11-10": 1841,
                    "2025-11-11": 1798, "2025-11-12": 1959, "2025-11-13": 1776, "2025-11-14": 1533, "2025-11-15": 1265,
                    "2025-11-16": 1400, "2025-11-17": 2418, "2025-11-18": 2099, "2025-11-19": 2913, "2025-11-20": 1789,
                    "2025-11-21": 1550, "2025-11-22": 1288, "2025-11-23": 1095
                },
                "/display/DXMB01B06": {
                    "2025-11-01": 821, "2025-11-02": 1430, "2025-11-03": 1407, "2025-11-04": 1109, "2025-11-05": 1263,
                    "2025-11-06": 1067, "2025-11-07": 982, "2025-11-08": 777, "2025-11-09": 974, "2025-11-10": 1162,
                    "2025-11-11": 1122, "2025-11-12": 1200, "2025-11-13": 1035, "2025-11-14": 1024, "2025-11-15": 1067,
                    "2025-11-16": 1238, "2025-11-17": 1787, "2025-11-18": 1636, "2025-11-19": 2121, "2025-11-20": 1340,
                    "2025-11-21": 1291, "2025-11-22": 1120, "2025-11-23": 952
                },
                "/display/DXMB01B06B02": {
                    "2025-11-01": 1279, "2025-11-02": 1880, "2025-11-03": 1782, "2025-11-04": 1416, "2025-11-05": 1293,
                    "2025-11-06": 1195, "2025-11-07": 1030, "2025-11-08": 1225, "2025-11-09": 1308, "2025-11-10": 1523,
                    "2025-11-11": 1252, "2025-11-12": 1433, "2025-11-13": 1190, "2025-11-14": 1222, "2025-11-15": 1369,
                    "2025-11-16": 1584, "2025-11-17": 2472, "2025-11-18": 2121, "2025-11-19": 2866, "2025-11-20": 2271,
                    "2025-11-21": 2140, "2025-11-22": 2442, "2025-11-23": 1871
                },
                "/display/DXMB01B06B03": {
                    "2025-11-01": 1573, "2025-11-02": 2428, "2025-11-03": 2140, "2025-11-04": 1827, "2025-11-05": 1763,
                    "2025-11-06": 1726, "2025-11-07": 1521, "2025-11-08": 1414, "2025-11-09": 1619, "2025-11-10": 1975,
                    "2025-11-11": 1773, "2025-11-12": 1925, "2025-11-13": 1542, "2025-11-14": 1480, "2025-11-15": 1660,
                    "2025-11-16": 1812, "2025-11-17": 2300, "2025-11-18": 1961, "2025-11-19": 2584, "2025-11-20": 1722,
                    "2025-11-21": 1376, "2025-11-22": 1470, "2025-11-23": 1367
                },
                "/display/DXMB02": {
                    "2025-11-01": 1517, "2025-11-02": 2308, "2025-11-03": 2525, "2025-11-04": 2270, "2025-11-05": 1897,
                    "2025-11-06": 2055, "2025-11-07": 1903, "2025-11-08": 1312, "2025-11-09": 1558, "2025-11-10": 2294,
                    "2025-11-11": 2059, "2025-11-12": 2123, "2025-11-13": 2047, "2025-11-14": 1697, "2025-11-15": 1430,
                    "2025-11-16": 1513, "2025-11-17": 2801, "2025-11-18": 2183, "2025-11-19": 3213, "2025-11-20": 2116,
                    "2025-11-21": 1937, "2025-11-22": 1456, "2025-11-23": 1274
                },
                "/display/DXMB02B06": {
                    "2025-11-01": 1380, "2025-11-02": 1930, "2025-11-03": 1789, "2025-11-04": 1374, "2025-11-05": 1375,
                    "2025-11-06": 1346, "2025-11-07": 1155, "2025-11-08": 1194, "2025-11-09": 1331, "2025-11-10": 1493,
                    "2025-11-11": 1383, "2025-11-12": 1401, "2025-11-13": 1339, "2025-11-14": 1202, "2025-11-15": 1100,
                    "2025-11-16": 1398, "2025-11-17": 2126, "2025-11-18": 1753, "2025-11-19": 2448, "2025-11-20": 1569,
                    "2025-11-21": 1548, "2025-11-22": 1317, "2025-11-23": 1221
                },
                "/display/DXMB02B06B01": {
                    "2025-11-01": 1297, "2025-11-02": 2060, "2025-11-03": 1783, "2025-11-04": 1367, "2025-11-05": 1313,
                    "2025-11-06": 1057, "2025-11-07": 1185, "2025-11-08": 1262, "2025-11-09": 1605, "2025-11-10": 1426,
                    "2025-11-11": 1343, "2025-11-12": 1351, "2025-11-13": 1226, "2025-11-14": 1345, "2025-11-15": 1404,
                    "2025-11-16": 1533, "2025-11-17": 2351, "2025-11-18": 2471, "2025-11-19": 3057, "2025-11-20": 2426,
                    "2025-11-21": 2118, "2025-11-22": 2162, "2025-11-23": 2098
                },
                "/display/DXMB02B06B02": {
                    "2025-11-01": 1642, "2025-11-02": 2693, "2025-11-03": 2248, "2025-11-04": 1714, "2025-11-05": 1583,
                    "2025-11-06": 1451, "2025-11-07": 1439, "2025-11-08": 1684, "2025-11-09": 1926, "2025-11-10": 1915,
                    "2025-11-11": 1616, "2025-11-12": 1622, "2025-11-13": 1635, "2025-11-14": 2054, "2025-11-15": 2526,
                    "2025-11-16": 2702, "2025-11-17": 3441, "2025-11-18": 2845, "2025-11-19": 3662, "2025-11-20": 3325,
                    "2025-11-21": 3100, "2025-11-22": 3792, "2025-11-23": 3568
                },
                "/display/DXMB02B06B03": {
                    "2025-11-01": 1911, "2025-11-02": 2584, "2025-11-03": 2304, "2025-11-04": 1975, "2025-11-05": 1780,
                    "2025-11-06": 1551, "2025-11-07": 1544, "2025-11-08": 1486, "2025-11-09": 1690, "2025-11-10": 1908,
                    "2025-11-11": 1670, "2025-11-12": 1639, "2025-11-13": 1426, "2025-11-14": 1555, "2025-11-15": 1563,
                    "2025-11-16": 1679, "2025-11-17": 2031, "2025-11-18": 1487, "2025-11-19": 2130, "2025-11-20": 1552,
                    "2025-11-21": 1365, "2025-11-22": 1461, "2025-11-23": 1351
                },
                "/display/DXMB02BST": {
                    "2025-11-01": 1316, "2025-11-02": 1844, "2025-11-03": 1392, "2025-11-04": 1147, "2025-11-05": 1041,
                    "2025-11-06": 1022, "2025-11-07": 851, "2025-11-08": 1070, "2025-11-09": 1163, "2025-11-10": 1114,
                    "2025-11-11": 1097, "2025-11-12": 917, "2025-11-13": 921, "2025-11-14": 1009, "2025-11-15": 1192,
                    "2025-11-16": 1333, "2025-11-17": 1556, "2025-11-18": 1229, "2025-11-19": 2125, "2025-11-20": 1320,
                    "2025-11-21": 1030, "2025-11-22": 1156, "2025-11-23": 1107
                }
            }
        };

        // í˜ì´ì§€ ê²½ë¡œë³„ ìƒ‰ìƒ ë°°ì—´ (Top 5ë§Œ)
        const pageColors = [
            '#3b82f6', // íŒŒë€ìƒ‰
            '#10b981', // ì´ˆë¡ìƒ‰
            '#f59e0b', // ë…¸ë€ìƒ‰
            '#ef4444', // ë¹¨ê°„ìƒ‰
            '#8b5cf6'  // ë³´ë¼ìƒ‰
        ];

        // í˜ì´ì§€ ê²½ë¡œë¥¼ ê°„ë‹¨í•œ ì´ë¦„ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
        function getSimplePageName(pagePath) {
            const nameMap = {
                '/display/DXMB02B06B02': 'ì—¬ì„± ë‹¤ìš´ - ìˆë‹¤ìš´',
                '/display/DXMB02B06B01': 'ì—¬ì„± ë‹¤ìš´ - ë¡±ë‹¤ìš´',
                '/display/DXMB01B06B02': 'ë‚¨ì„± ë‹¤ìš´ - ìˆë‹¤ìš´',
                '/display/DXMB02': 'ì—¬ì„± ì „ì²´',
                '/display/DXMB01': 'ë‚¨ì„± ì „ì²´'
            };
            return nameMap[pagePath] || pagePath;
        }

        // ì¼ìë³„ ì¶”ì´ ì°¨íŠ¸ ìƒì„±
        function createDailyTrendChart() {
            const ctx = document.getElementById('dailyTrendChart').getContext('2d');
            const dates = dailyTrafficData.dates;
            
            // í˜ì´ì§€ ì¡°íšŒìˆ˜ Top 5ë§Œ í•„í„°ë§ (pageData ê¸°ì¤€)
            const top5Pages = pageData.slice(0, 5).map(item => item.page_path);
            
            // ë‚ ì§œ í¬ë§·íŒ… (ì›”/ì¼)
            const formattedDates = dates.map(date => {
                const d = new Date(date);
                return `${d.getMonth() + 1}/${d.getDate()}`;
            });

            // ê° í˜ì´ì§€ë³„ ë°ì´í„°ì…‹ ìƒì„± (Top 5ë§Œ)
            const datasets = top5Pages.map((page, index) => {
                const pageData = dates.map(date => dailyTrafficData.daily_data[page][date] || 0);
                const simpleName = getSimplePageName(page);
                return {
                    label: simpleName + ' // ' + page, // ê°„ë‹¨í•œ ì´ë¦„ + ì£¼ì„ìœ¼ë¡œ ì „ì²´ ê²½ë¡œ
                    data: pageData,
                    borderColor: pageColors[index % pageColors.length],
                    backgroundColor: pageColors[index % pageColors.length] + '20',
                    borderWidth: 2,
                    fill: false,
                    tension: 0.4
                };
            });

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: formattedDates,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: "'Pretendard', 'Segoe UI', sans-serif",
                                    size: 11
                                },
                                padding: 15,
                                usePointStyle: true,
                                boxWidth: 12,
                                generateLabels: function(chart) {
                                    // ê°„ë‹¨í•œ ì´ë¦„ë§Œ ë²”ë¡€ì— í‘œì‹œ
                                    const original = Chart.defaults.plugins.legend.labels.generateLabels(chart);
                                    return original.map(label => {
                                        if (label.text && label.text.includes(' // ')) {
                                            label.text = label.text.split(' // ')[0];
                                        }
                                        return label;
                                    });
                                }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            font: {
                                family: "'Pretendard', 'Segoe UI', sans-serif"
                            },
                            callbacks: {
                                label: function(context) {
                                    // ê°„ë‹¨í•œ ì´ë¦„ë§Œ í‘œì‹œ (ì£¼ì„ ì œê±°)
                                    const label = context.dataset.label.split(' // ')[0];
                                    return label + ': ' + context.parsed.y.toLocaleString() + 'íšŒ';
                                },
                                afterLabel: function(context) {
                                    // ì£¼ì„ìœ¼ë¡œ ì „ì²´ ê²½ë¡œ í‘œì‹œ
                                    const fullPath = context.dataset.label.split(' // ')[1];
                                    return fullPath ? ' (' + fullPath + ')' : '';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    family: "'Pretendard', 'Segoe UI', sans-serif",
                                    size: 11
                                },
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#e5e7eb'
                            },
                            ticks: {
                                font: {
                                    family: "'Pretendard', 'Segoe UI', sans-serif",
                                    size: 11
                                },
                                callback: function(value) {
                                    return value.toLocaleString() + 'íšŒ';
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì°¨íŠ¸ ìƒì„±
        document.addEventListener('DOMContentLoaded', function() {
            createDailyTrendChart();
        });

        // ë°ì´í„°
        const pageData = [
            { rank: 1, page_path: "/display/DXMB02B06B02", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ì—¬ì„± ë‹¤ìš´, íŒ¨ë”© | ìˆë‹¤ìš´ë¶€í„° ë‘˜ëŸ¬ë³´ê¸°", page_views: 24188, prev_page_views: 13928, page_views_change_rate: 73.7, unique_visitors: 9721, prev_unique_visitors: 5693, unique_visitors_change_rate: 70.8, purchase_count: 155, prev_purchase_count: 85, purchase_count_change_rate: 82.4, revenue: 134019000, prev_revenue: 64139000, revenue_change_rate: 109.0 },
            { rank: 2, page_path: "/display/DXMB02B06B01", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ì—¬ì„± ë‹¤ìš´, íŒ¨ë”© | ë¡±ë‹¤ìš´ë¶€í„° ë‘˜ëŸ¬ë³´ê¸°", page_views: 17022, prev_page_views: 9568, page_views_change_rate: 77.9, unique_visitors: 7770, prev_unique_visitors: 4548, unique_visitors_change_rate: 70.8, purchase_count: 93, prev_purchase_count: 58, purchase_count_change_rate: 60.3, revenue: 124020000, prev_revenue: 50881000, revenue_change_rate: 143.7 },
            { rank: 3, page_path: "/display/DXMB01B06B02", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ë‚¨ì„± ë‹¤ìš´, íŒ¨ë”© | ìˆë‹¤ìš´ë¶€í„° ë‘˜ëŸ¬ë³´ê¸°", page_views: 16524, prev_page_views: 9466, page_views_change_rate: 74.6, unique_visitors: 7640, prev_unique_visitors: 4589, unique_visitors_change_rate: 66.5, purchase_count: 133, prev_purchase_count: 80, purchase_count_change_rate: 66.3, revenue: 128214000, prev_revenue: 81696000, revenue_change_rate: 56.9 },
            { rank: 4, page_path: "/display/DXMB02", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ì—¬ì„± | ì•„ìš°í„°, ìƒì˜, í•˜ì˜, ìŠ¤ìœ”ì›¨ì–´", page_views: 15366, prev_page_views: 13066, page_views_change_rate: 17.6, unique_visitors: 9126, prev_unique_visitors: 7534, unique_visitors_change_rate: 21.1, purchase_count: 194, prev_purchase_count: 168, purchase_count_change_rate: 15.5, revenue: 115270000, prev_revenue: 82221000, revenue_change_rate: 40.2 },
            { rank: 5, page_path: "/display/DXMB01", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ë‚¨ì„± | ì•„ìš°í„°, ìƒì˜, í•˜ì˜, ìŠ¤ìœ”ì›¨ì–´ ë“±", page_views: 13536, prev_page_views: 11459, page_views_change_rate: 18.1, unique_visitors: 8428, prev_unique_visitors: 6775, unique_visitors_change_rate: 24.4, purchase_count: 174, prev_purchase_count: 162, purchase_count_change_rate: 7.4, revenue: 101557000, prev_revenue: 77505000, revenue_change_rate: 31.0 },
            { rank: 6, page_path: "/display/DXMB01B06B03", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ë‚¨ì„± ë‹¤ìš´, íŒ¨ë”© | ê²½ëŸ‰ë‹¤ìš´ë¶€í„° ë‘˜ëŸ¬ë³´ê¸°", page_views: 13232, prev_page_views: 12004, page_views_change_rate: 10.2, unique_visitors: 6330, prev_unique_visitors: 5498, unique_visitors_change_rate: 15.1, purchase_count: 132, prev_purchase_count: 155, purchase_count_change_rate: -14.8, revenue: 120096000, prev_revenue: 126135000, revenue_change_rate: -4.8 },
            { rank: 7, page_path: "/display/DXMB02B06", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ì—¬ì„± ë‹¤ìš´, íŒ¨ë”© | ê²½ëŸ‰ë‹¤ìš´ë¶€í„° ë‹¤ìš´ë² ìŠ¤íŠ¸ê¹Œì§€", page_views: 12300, prev_page_views: 9223, page_views_change_rate: 33.4, unique_visitors: 5791, prev_unique_visitors: 4405, unique_visitors_change_rate: 31.5, purchase_count: 85, prev_purchase_count: 71, purchase_count_change_rate: 19.7, revenue: 70627000, prev_revenue: 97573000, revenue_change_rate: -27.6 },
            { rank: 8, page_path: "/display/DXMB02B06B03", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ì—¬ì„± ë‹¤ìš´, íŒ¨ë”© | ê²½ëŸ‰ë‹¤ìš´ë¶€í„° ë‘˜ëŸ¬ë³´ê¸°", page_views: 11701, prev_page_views: 11354, page_views_change_rate: 3.1, unique_visitors: 5811, prev_unique_visitors: 5460, unique_visitors_change_rate: 6.4, purchase_count: 116, prev_purchase_count: 133, purchase_count_change_rate: -12.8, revenue: 77883000, prev_revenue: 84076000, revenue_change_rate: -7.4 },
            { rank: 9, page_path: "/display/DXMB01B06", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ë‚¨ì„± ë‹¤ìš´, íŒ¨ë”© | ê²½ëŸ‰ë‹¤ìš´ë¶€í„° ë‹¤ìš´ë² ìŠ¤íŠ¸ê¹Œì§€", page_views: 10513, prev_page_views: 7757, page_views_change_rate: 35.5, unique_visitors: 5367, prev_unique_visitors: 3947, unique_visitors_change_rate: 36.0, purchase_count: 71, prev_purchase_count: 68, purchase_count_change_rate: 4.4, revenue: 58943000, prev_revenue: 46815000, revenue_change_rate: 25.9 },
            { rank: 10, page_path: "/display/DXMB02BST", page_title: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ì—¬ì„± ë² ìŠ¤íŠ¸ | ê°€ì¥ ì¸ê¸°ê°€ ë§ì€ ì—¬ì„± ì˜ë¥˜", page_views: 9813, prev_page_views: 7509, page_views_change_rate: 30.7, unique_visitors: 5171, prev_unique_visitors: 3777, unique_visitors_change_rate: 36.9, purchase_count: 150, prev_purchase_count: 97, purchase_count_change_rate: 54.6, revenue: 113990000, prev_revenue: 55374000, revenue_change_rate: 105.9 }
        ];

        // ì¦ê°ìœ¨ í¬ë§· í•¨ìˆ˜
        function formatChangeRate(rate) {
            if (rate === null || rate === undefined || isNaN(rate)) return '';
            const absRate = Math.abs(rate);
            const sign = rate >= 0 ? 'â–²' : 'â–¼';
            const colorClass = rate > 0 ? 'positive' : (rate < 0 ? 'negative' : 'neutral');
            return `<span class="change-rate ${colorClass}">${sign} ${absRate.toFixed(1)}%</span>`;
        }

        // ìƒí’ˆ ì¦ê°ìœ¨ í¬ë§· í•¨ìˆ˜
        function formatProductChangeRate(rate) {
            if (rate === null || rate === undefined || isNaN(rate)) return '';
            const absRate = Math.abs(rate);
            const sign = rate >= 0 ? 'â–²' : 'â–¼';
            const color = rate > 0 ? '#dc2626' : (rate < 0 ? '#3b82f6' : '#6b7280');
            return `<br><span style="color: ${color}; font-size: 0.85em; font-weight: 500;">${sign} ${absRate.toFixed(1)}%</span><span style="color: #999; font-size: 0.8em;"> (ì „ì£¼ ëŒ€ë¹„)</span>`;
        }

        // í…Œì´ë¸” ìƒì„±
        const tableBody = document.getElementById('tableBody');
        pageData.forEach((item) => {
            const row = document.createElement('tr');
            const purchaseCount = item.purchase_count || 0;
            
            let rankClass = '';
            if (item.rank === 1) rankClass = 'gold';
            else if (item.rank === 2) rankClass = 'silver';
            else if (item.rank === 3) rankClass = 'bronze';
            
            const fullUrl = `https://www.discovery-expedition.com${item.page_path}`;
            const pageTitle = item.page_title || '';
            const cleanTitle = pageTitle.replace('ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ', '');
            
            // ì¦ê°ìœ¨ ìƒ‰ìƒ ë° ì•„ì´ì½˜ ì„¤ì •
            const pageViewsChangeRate = item.page_views_change_rate || 0;
            const pageViewsChangeColor = pageViewsChangeRate >= 0 ? '#dc2626' : '#3b82f6';
            const pageViewsChangeIcon = pageViewsChangeRate >= 0 ? 'â–²' : 'â–¼';
            const pageViewsChangeDisplay = pageViewsChangeRate !== 0 ? `
                    <br>
                    <span style="color:${pageViewsChangeColor}; font-size:0.9em;">
                        ${pageViewsChangeIcon} ${Math.abs(pageViewsChangeRate).toFixed(1)}%
                    </span>
                    <span style="color:#6b7280; font-size:0.8em;"> (ì „ì£¼ ëŒ€ë¹„)</span>
                ` : '';
            
            const purchaseChangeRate = item.purchase_count_change_rate || 0;
            const purchaseChangeColor = purchaseChangeRate >= 0 ? '#dc2626' : '#3b82f6';
            const purchaseChangeIcon = purchaseChangeRate >= 0 ? 'â–²' : 'â–¼';
            const purchaseChangeDisplay = purchaseChangeRate !== 0 ? `
                    <br>
                    <span style="color:${purchaseChangeColor}; font-size:0.9em;">
                        ${purchaseChangeIcon} ${Math.abs(purchaseChangeRate).toFixed(1)}%
                    </span>
                    <span style="color:#6b7280; font-size:0.8em;"> (ì „ì£¼ ëŒ€ë¹„)</span>
                ` : '';
            
            const revenueChangeRate = item.revenue_change_rate || 0;
            const revenueChangeColor = revenueChangeRate >= 0 ? '#dc2626' : '#3b82f6';
            const revenueChangeIcon = revenueChangeRate >= 0 ? 'â–²' : 'â–¼';
            const revenueChangeDisplay = revenueChangeRate !== 0 ? `
                    <br>
                    <span style="color:${revenueChangeColor}; font-size:0.9em;">
                        ${revenueChangeIcon} ${Math.abs(revenueChangeRate).toFixed(1)}%
                    </span>
                    <span style="color:#6b7280; font-size:0.8em;"> (ì „ì£¼ ëŒ€ë¹„)</span>
                ` : '';
            
            row.innerHTML = `
                <td>${item.rank}</td>
                <td style="color:#374151;">
                    <a href="${fullUrl}" target="_blank" style="color:#374151; font-weight:600;">${item.page_path}</a>
                    ${pageTitle ? `<br><span style="color:#6b7280; font-size:0.9em;">${cleanTitle}</span>` : ''}
                </td>
                <td>
                    ${item.page_views.toLocaleString()}
                    ${pageViewsChangeDisplay}
                </td>
                <td>
                    ${purchaseCount.toLocaleString()}
                    ${purchaseChangeDisplay}
                </td>
                <td>
                    â‚©${(item.revenue || 0).toLocaleString()}
                    ${revenueChangeDisplay}
                </td>
            `;
            tableBody.appendChild(row);
        });

        // DXMB í˜ì´ì§€ë³„ select_item ë°ì´í„° (2025-11-17 ~ 2025-11-23)
        const dxmbSelectItemData = {
            "/display/DXMB02B06B02": [
                { item_id: "DWDJ94056-BKS", item_name: "ì—¬ì„± ì˜¬ë¦¬ì•„ ê¸€ë¡œìš° ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 2123 },
                { item_id: "DWDJ9G056-BKN", item_name: "ì—¬ì„± í—¤ì´ë‹ˆ ê¸€ë¡œìš° ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 1117 },
                { item_id: "DWDJ93056-BKS", item_name: "ì—¬ì„± ì˜¬ë¦¬ë¸Œ ê¸€ë¡œìš° ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 850 },
                { item_id: "DWDJ94056-CRN", item_name: "ì—¬ì„± ì˜¬ë¦¬ì•„ ê¸€ë¡œìš° ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 692 },
                { item_id: "DWDJ99056-BKS", item_name: "ì—¬ì„± ì¼ˆë¦¬ êµ¬ìŠ¤ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 562 }
            ],
            "/display/DXMB02B06B01": [
                { item_id: "DWDJ9A056-BKS", item_name: "ì—¬ì„± ì¼ˆë¦¬ êµ¬ìŠ¤ë‹¤ìš´ ë¡±íŒ¨ë”©", select_count: 1697 },
                { item_id: "DWDJ8F056-BKS", item_name: "ì—¬ì„± ë°˜ìŠ¬ë¦¬ ë‹¤ìš´ ë¡±íŒ¨ë”©", select_count: 1477 },
                { item_id: "DWDJ68056-BKS", item_name: "ì—¬ì„± ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ë¡±íŒ¨ë”©", select_count: 1170 },
                { item_id: "DWDJ98056-BKS", item_name: "ì—¬ì„± ì¼ˆë¦¬ êµ¬ìŠ¤ë‹¤ìš´ ë¯¸ë“œíŒ¨ë”©", select_count: 585 },
                { item_id: "DWDJ8F056-CRS", item_name: "ì—¬ì„± ë°˜ìŠ¬ë¦¬ ë‹¤ìš´ ë¡±íŒ¨ë”©", select_count: 503 }
            ],
            "/display/DXMB01B06B02": [
                { item_id: "DMDJ61056-BKS", item_name: "ë‚¨ì„± ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 681 },
                { item_id: "DXDJ8C056-BES", item_name: "ìœ ë‹ˆ ë°˜ìŠ¬ë¦¬ ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 642 },
                { item_id: "DMDJ5K056-BKL", item_name: "ë‚¨ì„± ì˜¬íŠ¼ ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 578 },
                { item_id: "DXDJ8C056-BKS", item_name: "ìœ ë‹ˆ ë°˜ìŠ¬ë¦¬ ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 467 },
                { item_id: "DMDJ7K056-BKS", item_name: "ë‚¨ì„± ë² ë¥´ê² ê³ ì–´ ìœˆë“œìŠ¤í† í¼ êµ¬ìŠ¤ë‹¤ìš´ ìˆíŒ¨ë”©", select_count: 417 }
            ]
        };

        // DXMB í˜ì´ì§€ë³„ ìƒí’ˆ ë°ì´í„° (í•´ë‹¹ í˜ì´ì§€ì—ì„œ ë°œìƒí•œ select_item + view_item í•©ì‚° ê¸°ì¤€, ì „ì£¼ ëŒ€ë¹„ í¬í•¨)
        // í˜„ì¬ ì£¼: 2025-11-17 ~ 2025-11-23 / ì „ì£¼: 2025-11-10 ~ 2025-11-16
        // ìƒí’ˆ ì¡°íšŒìˆ˜ = select_item + view_item (í•´ë‹¹ í˜ì´ì§€ì—ì„œ ì§ì ‘ ë°œìƒí•œ ì´ë²¤íŠ¸)
        const dxmbPageProductsData = {
            "/display/DXMB02B06B02": [
                { item_id: "DWDJ94056-BKS", item_name: "ì—¬ì„± ì˜¬ë¦¬ì•„ ê¸€ë¡œìš° ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 2163, prev_view_count: 1062, view_change_rate: 103.7, purchase_count: 20, prev_purchase_count: 6, purchase_change_rate: 233.3 },
                { item_id: "DWDJ9G056-BKN", item_name: "ì—¬ì„± í—¤ì´ë‹ˆ ê¸€ë¡œìš° ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 1136, prev_view_count: 831, view_change_rate: 36.7, purchase_count: 7, prev_purchase_count: 4, purchase_change_rate: 75.0 },
                { item_id: "DWDJ93056-BKS", item_name: "ì—¬ì„± ì˜¬ë¦¬ë¸Œ ê¸€ë¡œìš° ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 860, prev_view_count: 396, view_change_rate: 117.2, purchase_count: 7, prev_purchase_count: 3, purchase_change_rate: 133.3 },
                { item_id: "DWDJ94056-CRN", item_name: "ì—¬ì„± ì˜¬ë¦¬ì•„ ê¸€ë¡œìš° ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 704, prev_view_count: 607, view_change_rate: 16.0, purchase_count: 3, prev_purchase_count: 2, purchase_change_rate: 50.0 },
                { item_id: "DWDJ99056-BKS", item_name: "ì—¬ì„± ì¼ˆë¦¬ êµ¬ìŠ¤ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 567, prev_view_count: 409, view_change_rate: 38.6, purchase_count: 7, prev_purchase_count: 4, purchase_change_rate: 75.0 }
            ],
            "/display/DXMB02B06B01": [
                { item_id: "DWDJ9A056-BKS", item_name: "ì—¬ì„± ì¼ˆë¦¬ êµ¬ìŠ¤ë‹¤ìš´ ë¡±íŒ¨ë”©", view_count: 1736, prev_view_count: 1059, view_change_rate: 63.9, purchase_count: 14, prev_purchase_count: 5, purchase_change_rate: 180.0 },
                { item_id: "DWDJ8F056-BKS", item_name: "ì—¬ì„± ë°˜ìŠ¬ë¦¬ ë‹¤ìš´ ë¡±íŒ¨ë”©", view_count: 1498, prev_view_count: 532, view_change_rate: 181.6, purchase_count: 18, prev_purchase_count: 7, purchase_change_rate: 157.1 },
                { item_id: "DWDJ68056-BKS", item_name: "ì—¬ì„± ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ë¡±íŒ¨ë”©", view_count: 1186, prev_view_count: 575, view_change_rate: 106.3, purchase_count: 8, prev_purchase_count: 4, purchase_change_rate: 100.0 },
                { item_id: "DWDJ98056-BKS", item_name: "ì—¬ì„± ì¼ˆë¦¬ êµ¬ìŠ¤ë‹¤ìš´ ë¯¸ë“œíŒ¨ë”©", view_count: 600, prev_view_count: 411, view_change_rate: 46.0, purchase_count: 7, prev_purchase_count: 3, purchase_change_rate: 133.3 },
                { item_id: "DWDJ8F056-CRS", item_name: "ì—¬ì„± ë°˜ìŠ¬ë¦¬ ë‹¤ìš´ ë¡±íŒ¨ë”©", view_count: 508, prev_view_count: 265, view_change_rate: 91.7, purchase_count: 0, prev_purchase_count: 0, purchase_change_rate: null }
            ],
            "/display/DXMB01B06B02": [
                { item_id: "DMDJ61056-BKS", item_name: "ë‚¨ì„± ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 689, prev_view_count: 413, view_change_rate: 66.8, purchase_count: 16, prev_purchase_count: 12, purchase_change_rate: 33.3 },
                { item_id: "DXDJ8C056-BES", item_name: "ìœ ë‹ˆ ë°˜ìŠ¬ë¦¬ ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 663, prev_view_count: 427, view_change_rate: 55.3, purchase_count: 3, prev_purchase_count: 1, purchase_change_rate: 200.0 },
                { item_id: "DMDJ5K056-BKL", item_name: "ë‚¨ì„± ì˜¬íŠ¼ ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 581, prev_view_count: 332, view_change_rate: 75.0, purchase_count: 4, prev_purchase_count: 0, purchase_change_rate: null },
                { item_id: "DXDJ8C056-BKS", item_name: "ìœ ë‹ˆ ë°˜ìŠ¬ë¦¬ ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 476, prev_view_count: 213, view_change_rate: 123.5, purchase_count: 11, prev_purchase_count: 4, purchase_change_rate: 175.0 },
                { item_id: "DMDJ7K056-BKS", item_name: "ë‚¨ì„± ë² ë¥´ê² ê³ ì–´ ìœˆë“œìŠ¤í† í¼ êµ¬ìŠ¤ë‹¤ìš´ ìˆíŒ¨ë”©", view_count: 425, prev_view_count: 269, view_change_rate: 58.0, purchase_count: 4, prev_purchase_count: 2, purchase_change_rate: 100.0 }
            ]
        };

        // DXMB í˜ì´ì§€ë³„ ìƒí’ˆ Top 5 í…Œì´ë¸” ë Œë”ë§
        function renderDxmbProducts() {
            const container = document.getElementById('dxmbProductsContainer');
            if (!container) return;

            if (Object.keys(dxmbPageProductsData).length === 0) {
                container.innerHTML = '<p style="color: #999; padding: 20px;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            let html = '';
            for (const [pagePath, products] of Object.entries(dxmbPageProductsData)) {
                // í˜ì´ì§€ ì´ë¦„ ê°„ë‹¨í•˜ê²Œ
                const pageName = getSimplePageName(pagePath);
                
                html += `
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #1a1a1a; font-size: 1.2em; margin-bottom: 15px; font-weight: 700;">
                            ${pageName} <span style="color: #6b7280; font-size: 0.85em; font-weight: 400;">(${pagePath})</span>
                        </h3>
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.95em;">
                            <thead>
                                <tr style="background: #374151; color: #ffffff;">
                                    <th style="padding: 12px; text-align: left; font-weight: 600;">ìˆœìœ„</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600;">ìƒí’ˆ ID / ìƒí’ˆëª…</th>
                                    <th style="padding: 12px; text-align: right; font-weight: 600;">ìƒí’ˆ ì¡°íšŒìˆ˜</th>
                                    <th style="padding: 12px; text-align: right; font-weight: 600;">êµ¬ë§¤ ìˆ˜</th>
                                    <th style="padding: 12px; text-align: right; font-weight: 600;">ì „í™˜ìœ¨</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${products.map((product, index) => {
                                    // ì¦ê°ìœ¨ í¬ë§·íŒ… (ëª¨ë“  í˜ì´ì§€ ë™ì¼í•˜ê²Œ ì²˜ë¦¬)
                                    const viewChangeRate = product.view_change_rate !== null && product.view_change_rate !== undefined 
                                        ? product.view_change_rate 
                                        : null;
                                    const purchaseChangeRate = product.purchase_change_rate !== null && product.purchase_change_rate !== undefined 
                                        ? product.purchase_change_rate 
                                        : null;
                                    
                                    // ìƒí’ˆ ì¡°íšŒìˆ˜ ì „ì£¼ ëŒ€ë¹„ ì¦ê° í‘œì‹œ
                                    const viewChangeDisplay = viewChangeRate !== null 
                                        ? formatProductChangeRate(viewChangeRate)
                                        : '';
                                    
                                    // êµ¬ë§¤ìˆ˜ ì „ì£¼ ëŒ€ë¹„ ì¦ê° í‘œì‹œ
                                    const purchaseChangeDisplay = purchaseChangeRate !== null 
                                        ? formatProductChangeRate(purchaseChangeRate)
                                        : '';
                                    
                                    // ì „í™˜ìœ¨ ê³„ì‚° (êµ¬ë§¤ ìˆ˜ / ìƒí’ˆ ì¡°íšŒìˆ˜ * 100)
                                    const conversionRate = product.view_count > 0 
                                        ? ((product.purchase_count / product.view_count) * 100)
                                        : 0;
                                    const conversionRateText = conversionRate.toFixed(2);
                                    
                                    // ì „ì£¼ ì „í™˜ìœ¨ ê³„ì‚°
                                    const prevConversionRate = product.prev_view_count > 0 
                                        ? ((product.prev_purchase_count / product.prev_view_count) * 100)
                                        : 0;
                                    
                                    // ì „í™˜ìœ¨ ì¦ê° ê³„ì‚° (í¬ì¸íŠ¸ ì°¨ì´)
                                    const conversionRateChange = prevConversionRate > 0 || prevConversionRate === 0 
                                        ? (conversionRate - prevConversionRate) 
                                        : null;
                                    
                                    // ì „í™˜ìœ¨ ì¦ê° í‘œì‹œ
                                    const conversionRateChangeDisplay = conversionRateChange !== null && !isNaN(conversionRateChange)
                                        ? formatProductChangeRate(conversionRateChange)
                                        : '';
                                    
                                    return `
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 12px;">
                                            <span style="display: inline-block; width: 30px; height: 30px; line-height: 30px; text-align: center; border-radius: 50%; font-weight: 700; color: white; background: ${index === 0 ? '#f59e0b' : index === 1 ? '#6b7280' : index === 2 ? '#d97706' : '#374151'};">
                                                ${index + 1}
                                            </span>
                                        </td>
                                        <td style="padding: 12px;">
                                            <span style="color: #374151; font-weight: 600; display: block; margin-bottom: 4px;">${product.item_id}</span>
                                            <span style="color: #6b7280; font-size: 0.9em; display: block;">${product.item_name}</span>
                                        </td>
                                        <td style="padding: 12px; text-align: right;">
                                            <span style="color: #1a1a1a; font-weight: 600;">${product.view_count.toLocaleString()}</span>
                                            ${viewChangeDisplay}
                                        </td>
                                        <td style="padding: 12px; text-align: right;">
                                            <span style="color: #1a1a1a; font-weight: 600;">${product.purchase_count.toLocaleString()}</span>
                                            ${purchaseChangeDisplay}
                                        </td>
                                        <td style="padding: 12px; text-align: right;">
                                            <span style="color: #1a1a1a; font-weight: 600;">${conversionRateText}%</span>
                                            ${conversionRateChangeDisplay}
                                        </td>
                                    </tr>
                                `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        // ì¸ì‚¬ì´íŠ¸ ë Œë”ë§ í•¨ìˆ˜
        function renderInsights() {
            const container = document.getElementById('insightsContainer');
            if (!container) return;

            // ì¼ìë³„ í˜ì´ì§€ ì¡°íšŒìˆ˜ ì¶”ì´ ê¸°ë°˜ ì˜ˆì¸¡ ë¶„ì„
            const trendInsights = [];
            const top5Pages = pageData.slice(0, 5);
            
            top5Pages.forEach(page => {
                const pagePath = page.page_path;
                const pageDailyData = dailyTrafficData.daily_data[pagePath];
                if (!pageDailyData) return;
                
                const dates = dailyTrafficData.dates;
                const currentWeekDates = dates.slice(-7); // í˜„ì¬ ì£¼ (11/17~11/23)
                const prevWeekDates = dates.slice(-14, -7); // ì „ì£¼ (11/10~11/16)
                
                // í˜„ì¬ ì£¼ ë°ì´í„°
                const currentWeekData = currentWeekDates.map(date => pageDailyData[date] || 0);
                const currentWeekAvg = currentWeekData.reduce((a, b) => a + b, 0) / currentWeekData.length;
                const currentWeekMax = Math.max(...currentWeekData);
                const currentWeekMaxDate = currentWeekDates[currentWeekData.indexOf(currentWeekMax)];
                
                // ì „ì£¼ ë°ì´í„°
                const prevWeekData = prevWeekDates.map(date => pageDailyData[date] || 0);
                const prevWeekAvg = prevWeekData.reduce((a, b) => a + b, 0) / prevWeekData.length;
                
                // ì£¼ì¤‘(ì›”~ê¸ˆ) vs ì£¼ë§(í† ~ì¼) íŒ¨í„´
                const weekdayData = [];
                const weekendData = [];
                currentWeekDates.forEach((date, idx) => {
                    const dayOfWeek = new Date(date).getDay();
                    const views = pageDailyData[date] || 0;
                    if (dayOfWeek === 0 || dayOfWeek === 6) {
                        weekendData.push(views);
                    } else {
                        weekdayData.push(views);
                    }
                });
                const weekdayAvg = weekdayData.length > 0 ? weekdayData.reduce((a, b) => a + b, 0) / weekdayData.length : 0;
                const weekendAvg = weekendData.length > 0 ? weekendData.reduce((a, b) => a + b, 0) / weekendData.length : 0;
                
                // ì¦ê°€ìœ¨ ê³„ì‚°
                const growthRate = prevWeekAvg > 0 ? ((currentWeekAvg - prevWeekAvg) / prevWeekAvg * 100) : 0;
                
                // íŠ¸ë Œë“œ ë¶„ì„
                let trendType = '';
                let action = '';
                let urgency = 'normal';
                
                if (growthRate > 50) {
                    trendType = 'ê¸‰ì„±ì¥';
                    urgency = 'high';
                    action = 'ì¬ê³  í™•ë³´ ë° ë§ˆì¼€íŒ… ì§‘ì¤‘ íˆ¬ì í•„ìš”';
                } else if (growthRate > 20) {
                    trendType = 'ì„±ì¥';
                    urgency = 'medium';
                    action = 'ë§ˆì¼€íŒ… ê°•í™” ë° ìƒí’ˆ ë°°ì¹˜ ìµœì í™”';
                } else if (growthRate < -20) {
                    trendType = 'ê°ì†Œ';
                    urgency = 'warning';
                    action = 'í”„ë¡œëª¨ì…˜ ê°•í™” ë° í¬ë¦¬ì—ì´í‹°ë¸Œ ê°œì„ ';
                } else {
                    trendType = 'ì•ˆì •';
                    urgency = 'normal';
                    action = 'í˜„ì¬ ì „ëµ ìœ ì§€';
                }
                
                // í”¼í¬ ë‚ ì§œ ë¶„ì„
                const peakDayName = new Date(currentWeekMaxDate).toLocaleDateString('ko-KR', { weekday: 'short' });
                const isWeekendPeak = new Date(currentWeekMaxDate).getDay() === 0 || new Date(currentWeekMaxDate).getDay() === 6;
                
                trendInsights.push({
                    pagePath: pagePath,
                    pageName: getSimplePageName(pagePath),
                    growthRate: growthRate,
                    currentWeekAvg: currentWeekAvg,
                    prevWeekAvg: prevWeekAvg,
                    weekdayAvg: weekdayAvg,
                    weekendAvg: weekendAvg,
                    peakDate: currentWeekMaxDate,
                    peakDayName: peakDayName,
                    isWeekendPeak: isWeekendPeak,
                    trendType: trendType,
                    action: action,
                    urgency: urgency,
                    pageViews: page.page_views
                });
            });
            
            // ê¸‰ì„±ì¥ íŠ¸ë Œë“œ ìš°ì„  ì •ë ¬
            trendInsights.sort((a, b) => b.growthRate - a.growthRate);
            const highGrowthTrends = trendInsights.filter(t => t.growthRate > 50);
            
            // ìµœê·¼ ì¡°íšŒìˆ˜ ë³¼ë¥¨ ê¸°ì¤€ ì •ë ¬ (ê¸‰ì„±ì¥ ì œì™¸)
            const volumeBasedTrends = trendInsights
                .filter(t => t.growthRate <= 50)
                .sort((a, b) => b.currentWeekAvg - a.currentWeekAvg);

            // ì¹´í…Œê³ ë¦¬ ë¶„ì„ í•¨ìˆ˜
            function getCategoryInfo(pagePath) {
                let gender = '';
                let category = '';
                let subCategory = '';
                
                if (pagePath.includes('DXMB02')) {
                    gender = 'ì—¬ì„±';
                } else if (pagePath.includes('DXMB01')) {
                    gender = 'ë‚¨ì„±';
                }
                
                if (pagePath.includes('B06B02')) {
                    category = 'ë‹¤ìš´/íŒ¨ë”©';
                    subCategory = 'ìˆë‹¤ìš´';
                } else if (pagePath.includes('B06B01')) {
                    category = 'ë‹¤ìš´/íŒ¨ë”©';
                    subCategory = 'ë¡±ë‹¤ìš´';
                } else if (pagePath.includes('B06B03')) {
                    category = 'ë‹¤ìš´/íŒ¨ë”©';
                    subCategory = 'ê²½ëŸ‰ë‹¤ìš´';
                } else if (pagePath.includes('B06')) {
                    category = 'ë‹¤ìš´/íŒ¨ë”©';
                    subCategory = 'ì „ì²´';
                } else if (pagePath.includes('BST')) {
                    category = 'ë² ìŠ¤íŠ¸';
                    subCategory = '';
                } else {
                    category = 'ì „ì²´';
                    subCategory = '';
                }
                
                return { gender, category, subCategory, fullCategory: subCategory ? `${gender} ${category} - ${subCategory}` : `${gender} ${category}` };
            }
            
            // ë°ì´í„° ë¶„ì„
            const top3Pages = pageData.slice(0, 3);
            
            // ì¹´í…Œê³ ë¦¬ë³„ ì§‘ê³„
            const categoryAnalysis = {};
            top3Pages.forEach(page => {
                const catInfo = getCategoryInfo(page.page_path);
                const key = catInfo.fullCategory;
                const trendData = trendInsights.find(t => t.pagePath === page.page_path);
                
                if (!categoryAnalysis[key]) {
                    categoryAnalysis[key] = {
                        category: key,
                        gender: catInfo.gender,
                        categoryType: catInfo.category,
                        subCategory: catInfo.subCategory,
                        totalPageViews: 0,
                        totalPurchaseCount: 0,
                        avgGrowthRate: 0,
                        avgPurchaseGrowthRate: 0,
                        pages: [],
                        totalRevenue: 0
                    };
                }
                
                categoryAnalysis[key].totalPageViews += page.page_views;
                categoryAnalysis[key].totalPurchaseCount += page.purchase_count;
                categoryAnalysis[key].totalRevenue += page.revenue || 0;
                categoryAnalysis[key].pages.push(page);
                
                if (trendData) {
                    categoryAnalysis[key].avgGrowthRate = (categoryAnalysis[key].avgGrowthRate * (categoryAnalysis[key].pages.length - 1) + trendData.growthRate) / categoryAnalysis[key].pages.length;
                }
                categoryAnalysis[key].avgPurchaseGrowthRate = (categoryAnalysis[key].avgPurchaseGrowthRate * (categoryAnalysis[key].pages.length - 1) + page.purchase_count_change_rate) / categoryAnalysis[key].pages.length;
            });
            
            // ì¹´í…Œê³ ë¦¬ë³„ ìš°ì„ ìˆœìœ„ ì •ë ¬ (ì„±ì¥ë¥  + ë³¼ë¥¨ ê¸°ì¤€)
            const sortedCategories = Object.values(categoryAnalysis)
                .sort((a, b) => {
                    // ì„±ì¥ë¥  ê°€ì¤‘ì¹˜ 60%, ë³¼ë¥¨ ê°€ì¤‘ì¹˜ 40%
                    const scoreA = (a.avgGrowthRate * 0.6) + (a.totalPageViews / 1000 * 0.4);
                    const scoreB = (b.avgGrowthRate * 0.6) + (b.totalPageViews / 1000 * 0.4);
                    return scoreB - scoreA;
                });
            
            // ì„±ê³¼ ì €í•˜ ì¹´í…Œê³ ë¦¬ ë¶„ì„
            const decliningPages = pageData.filter(p => p.purchase_count_change_rate < 0 || p.page_views_change_rate < 0);
            const decliningCategoryAnalysis = {};
            
            decliningPages.forEach(page => {
                const catInfo = getCategoryInfo(page.page_path);
                const key = catInfo.fullCategory;
                const trendData = trendInsights.find(t => t.pagePath === page.page_path);
                
                if (!decliningCategoryAnalysis[key]) {
                    decliningCategoryAnalysis[key] = {
                        category: key,
                        gender: catInfo.gender,
                        categoryType: catInfo.category,
                        subCategory: catInfo.subCategory,
                        totalPageViews: 0,
                        totalPurchaseCount: 0,
                        avgDeclineRate: 0,
                        avgPurchaseDeclineRate: 0,
                        pages: [],
                        totalRevenue: 0
                    };
                }
                
                decliningCategoryAnalysis[key].totalPageViews += page.page_views;
                decliningCategoryAnalysis[key].totalPurchaseCount += page.purchase_count;
                decliningCategoryAnalysis[key].totalRevenue += page.revenue || 0;
                decliningCategoryAnalysis[key].pages.push(page);
                
                const pageDeclineRate = page.page_views_change_rate < 0 ? Math.abs(page.page_views_change_rate) : 0;
                const purchaseDeclineRate = page.purchase_count_change_rate < 0 ? Math.abs(page.purchase_count_change_rate) : 0;
                
                decliningCategoryAnalysis[key].avgDeclineRate = (decliningCategoryAnalysis[key].avgDeclineRate * (decliningCategoryAnalysis[key].pages.length - 1) + pageDeclineRate) / decliningCategoryAnalysis[key].pages.length;
                decliningCategoryAnalysis[key].avgPurchaseDeclineRate = (decliningCategoryAnalysis[key].avgPurchaseDeclineRate * (decliningCategoryAnalysis[key].pages.length - 1) + purchaseDeclineRate) / decliningCategoryAnalysis[key].pages.length;
            });
            
            // ì„±ê³¼ ì €í•˜ ì¹´í…Œê³ ë¦¬ ì •ë ¬ (ê°ì†Œìœ¨ ê¸°ì¤€)
            const sortedDecliningCategories = Object.values(decliningCategoryAnalysis)
                .filter(cat => cat.avgDeclineRate > 0 || cat.avgPurchaseDeclineRate > 0)
                .sort((a, b) => {
                    // ê°ì†Œìœ¨ ê°€ì¤‘ì¹˜ 60%, ë³¼ë¥¨ ê°€ì¤‘ì¹˜ 40%
                    const scoreA = ((a.avgDeclineRate + a.avgPurchaseDeclineRate) * 0.6) + (a.totalPageViews / 1000 * 0.4);
                    const scoreB = ((b.avgDeclineRate + b.avgPurchaseDeclineRate) * 0.6) + (b.totalPageViews / 1000 * 0.4);
                    return scoreB - scoreA;
                });
            
            // ê¸‰ì„±ì¥ ìƒí’ˆ ë¶„ì„
            const highGrowthProducts = [];
            for (const [pagePath, products] of Object.entries(dxmbPageProductsData)) {
                products.forEach(product => {
                    if (product.purchase_change_rate && product.purchase_change_rate > 100) {
                        highGrowthProducts.push({
                            ...product,
                            pagePath: pagePath,
                            pageName: getSimplePageName(pagePath)
                        });
                    }
                });
            }
            highGrowthProducts.sort((a, b) => (b.purchase_change_rate || 0) - (a.purchase_change_rate || 0));
            
            // ì „í™˜ìœ¨ ë¶„ì„
            const conversionRates = [];
            for (const [pagePath, products] of Object.entries(dxmbPageProductsData)) {
                products.forEach(product => {
                    const conversionRate = product.view_count > 0 ? (product.purchase_count / product.view_count * 100) : 0;
                    conversionRates.push({
                        ...product,
                        pagePath: pagePath,
                        pageName: getSimplePageName(pagePath),
                        conversionRate: conversionRate
                    });
                });
            }
            conversionRates.sort((a, b) => b.conversionRate - a.conversionRate);
            const topConversionProducts = conversionRates.slice(0, 3);

            let html = `
                <!-- ì¼ìë³„ í˜ì´ì§€ ì¡°íšŒìˆ˜ ì¶”ì´ ê¸°ë°˜ ì˜ˆì¸¡ ì¸ì‚¬ì´íŠ¸ -->
                <div style="background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%); border-left: 4px solid #3b82f6; border-radius: 12px; padding: 20px; margin-bottom: 30px;">
                    <!-- ì§‘ì¤‘ í•„ìš” ì¹´í…Œê³ ë¦¬ ì¸ì‚¬ì´íŠ¸ -->
                    ${sortedCategories.length > 0 ? `
                    <div style="background: white; border-radius: 8px; padding: 18px;">
                        <h4 style="color: #059669; margin-bottom: 12px; font-size: 1.1em; font-weight: 700;">ğŸ¯ ìµœê·¼ ì§‘ì¤‘ í•„ìš” ì¹´í…Œê³ ë¦¬</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                            ${sortedCategories.slice(0, 3).map((cat, idx) => `
                                <div style="border-left: 3px solid ${idx === 0 ? '#dc2626' : idx === 1 ? '#f59e0b' : '#3b82f6'}; padding-left: 12px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <span style="font-size: 1.5em; margin-right: 8px;">${idx === 0 ? 'ğŸ¥‡' : idx === 1 ? 'ğŸ¥ˆ' : 'ğŸ¥‰'}</span>
                                        <strong style="color: #1a1a1a; font-size: 0.95em;">${cat.category}</strong>
                                    </div>
                                    <div style="color: #6b7280; font-size: 0.9em; line-height: 1.6;">
                                        <div>ì´ ì¡°íšŒìˆ˜: <strong>${cat.totalPageViews.toLocaleString()}</strong>íšŒ</div>
                                        <div>êµ¬ë§¤ìˆ˜: <strong>${cat.totalPurchaseCount}</strong>ê±´</div>
                                        ${cat.avgGrowthRate > 0 ? `<div>ì¡°íšŒìˆ˜ ì¦ê°€ìœ¨: â–²<strong>${cat.avgGrowthRate.toFixed(1)}%</strong></div>` : ''}
                                        ${cat.avgPurchaseGrowthRate > 0 ? `<div>êµ¬ë§¤ ì¦ê°€ìœ¨: â–²<strong>${cat.avgPurchaseGrowthRate.toFixed(1)}%</strong></div>` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                    
                    <!-- ì„±ê³¼ ì €í•˜ ì¹´í…Œê³ ë¦¬ ì¸ì‚¬ì´íŠ¸ -->
                    ${sortedDecliningCategories.length > 0 ? `
                    <div style="background: white; border-radius: 8px; padding: 18px; margin-top: 15px;">
                        <h4 style="color: #dc2626; margin-bottom: 12px; font-size: 1.1em; font-weight: 700;">âš ï¸ ìµœê·¼ ì„±ê³¼ ì €í•˜ ì¹´í…Œê³ ë¦¬</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                            ${sortedDecliningCategories.slice(0, 3).map((cat, idx) => `
                                <div style="border-left: 3px solid #dc2626; padding-left: 12px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <span style="font-size: 1.2em; margin-right: 8px;">âš ï¸</span>
                                        <strong style="color: #1a1a1a; font-size: 0.95em;">${cat.category}</strong>
                                    </div>
                                    <div style="color: #6b7280; font-size: 0.9em; line-height: 1.6;">
                                        <div>ì´ ì¡°íšŒìˆ˜: <strong>${cat.totalPageViews.toLocaleString()}</strong>íšŒ</div>
                                        <div>êµ¬ë§¤ìˆ˜: <strong>${cat.totalPurchaseCount}</strong>ê±´</div>
                                        ${cat.avgDeclineRate > 0 ? `<div>ì¡°íšŒìˆ˜ ê°ì†Œìœ¨: â–¼<strong>${cat.avgDeclineRate.toFixed(1)}%</strong></div>` : ''}
                                        ${cat.avgPurchaseDeclineRate > 0 ? `<div>êµ¬ë§¤ ê°ì†Œìœ¨: â–¼<strong>${cat.avgPurchaseDeclineRate.toFixed(1)}%</strong></div>` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                </div>

            `;

            container.innerHTML = html;
        }

        // ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ ê´€ë¦¬ í¬ì¸íŠ¸ ë Œë”ë§ í•¨ìˆ˜
        function renderManagementPoints() {
            const container = document.getElementById('managementPointsContainer');
            if (!container) return;

            // ì „í™˜ìœ¨ ê³„ì‚°
            const conversionRates = {};
            for (const [pagePath, products] of Object.entries(dxmbPageProductsData)) {
                let totalViews = 0;
                let totalPurchases = 0;
                products.forEach(product => {
                    totalViews += product.view_count;
                    totalPurchases += product.purchase_count;
                });
                const avgConversion = totalViews > 0 ? (totalPurchases / totalViews * 100) : 0;
                conversionRates[pagePath] = avgConversion.toFixed(2);
            }

            // ì»¬ëŸ¬ë³„ ë¶„ì„ (ìƒí’ˆ IDì—ì„œ ì»¬ëŸ¬ ì½”ë“œ ì¶”ì¶œ)
            const colorAnalysis = {};
            
            // select_item ë°ì´í„°ë¥¼ ì»¬ëŸ¬ë³„ë¡œ ì§‘ê³„
            for (const [pagePath, selectItems] of Object.entries(dxmbSelectItemData)) {
                if (!colorAnalysis[pagePath]) colorAnalysis[pagePath] = {};
                selectItems.forEach(item => {
                    // ìƒí’ˆ IDì—ì„œ ì»¬ëŸ¬ ì½”ë“œ ì¶”ì¶œ (ì˜ˆ: DWDJ94056-BKS -> BKS)
                    const colorMatch = item.item_id.match(/-([A-Z]+)$/);
                    if (colorMatch) {
                        const colorCode = colorMatch[1];
                        if (!colorAnalysis[pagePath][colorCode]) {
                            colorAnalysis[pagePath][colorCode] = {
                                select_count: 0,
                                view_count: 0,
                                purchase_count: 0,
                                products: []
                            };
                        }
                        colorAnalysis[pagePath][colorCode].select_count += item.select_count;
                        colorAnalysis[pagePath][colorCode].products.push(item.item_name);
                    }
                });
            }

            // view_countì™€ purchase_count ì¶”ê°€ (dxmbPageProductsDataì—ì„œ)
            for (const [pagePath, products] of Object.entries(dxmbPageProductsData)) {
                if (!colorAnalysis[pagePath]) colorAnalysis[pagePath] = {};
                products.forEach(product => {
                    const colorMatch = product.item_id.match(/-([A-Z]+)$/);
                    if (colorMatch) {
                        const colorCode = colorMatch[1];
                        if (!colorAnalysis[pagePath][colorCode]) {
                            colorAnalysis[pagePath][colorCode] = {
                                select_count: 0,
                                view_count: 0,
                                purchase_count: 0,
                                products: []
                            };
                        }
                        colorAnalysis[pagePath][colorCode].view_count += product.view_count;
                        colorAnalysis[pagePath][colorCode].purchase_count += product.purchase_count;
                    }
                });
            }

            // Top ìƒí’ˆë³„ ì „í™˜ìœ¨ ê³„ì‚°
            const topProductsByConversion = [];
            for (const [pagePath, products] of Object.entries(dxmbPageProductsData)) {
                products.forEach(product => {
                    const conversion = product.view_count > 0 ? (product.purchase_count / product.view_count * 100) : 0;
                    topProductsByConversion.push({
                        ...product,
                        pagePath: pagePath,
                        pageName: getSimplePageName(pagePath),
                        conversionRate: conversion
                    });
                });
            }
            topProductsByConversion.sort((a, b) => b.conversionRate - a.conversionRate);
            const top3Conversion = topProductsByConversion.slice(0, 3);

            // ê¸‰ì„±ì¥ ìƒí’ˆ (êµ¬ë§¤ ì¦ê°€ìœ¨ 100% ì´ìƒ)
            const highGrowthProducts = [];
            for (const [pagePath, products] of Object.entries(dxmbPageProductsData)) {
                products.forEach(product => {
                    if (product.purchase_change_rate && product.purchase_change_rate >= 100) {
                        highGrowthProducts.push({
                            ...product,
                            pagePath: pagePath,
                            pageName: getSimplePageName(pagePath)
                        });
                    }
                });
            }
            highGrowthProducts.sort((a, b) => (b.purchase_change_rate || 0) - (a.purchase_change_rate || 0));

            let html = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <!-- ìƒí’ˆ ë…¸ì¶œ ìˆœì„œ ìµœì í™” -->
                    <div style="background: linear-gradient(135deg, #dbeafe 0%, #e0f2fe 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #3b82f6;">
                        <h3 style="color: #1a1a1a; font-size: 1.1em; margin-bottom: 14px; font-weight: 700;">ğŸ¯ ìƒí’ˆ ë…¸ì¶œ ìˆœì„œ ìµœì í™”</h3>
                        <ul style="list-style: none; margin: 0; padding: 0; color: #1a1a1a; font-size: 0.9em; line-height: 1.7;">
                            <li style="margin-bottom: 10px;">
                                <strong>âœ“ ë™ì  ì •ë ¬ ê¸°ì¤€</strong><br>
                                <span style="color: #6b7280; font-size: 0.9em;">select_item ì´ë²¤íŠ¸ ìˆ˜ + ì „í™˜ìœ¨ ê¸°ì¤€</span>
                            </li>
                            <li style="margin-bottom: 10px;">
                                <strong>âœ“ ìƒë‹¨ ë°°ì¹˜ ìƒí’ˆ</strong><br>
                                <span style="color: #6b7280; font-size: 0.9em;">ì „í™˜ìœ¨ 0.5% ì´ìƒ ë˜ëŠ” ì¦ê°ìœ¨ 50% ì´ìƒ</span>
                            </li>
                            <li style="margin-bottom: 10px;">
                                <strong>âœ“ ìš°ì„ ìˆœìœ„</strong><br>
                                <span style="color: #6b7280; font-size: 0.9em;">1) ì „í™˜ìœ¨ 2) select_item ìˆ˜ 3) ì¦ê°ìœ¨</span>
                            </li>
                        </ul>
                    </div>

                    <!-- ì „í™˜ìœ¨ ìµœì í™” -->
                    <div style="background: linear-gradient(135deg, #dcfce7 0%, #d1fae5 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #10b981;">
                        <h3 style="color: #1a1a1a; font-size: 1.1em; margin-bottom: 14px; font-weight: 700;">ğŸ“ˆ ì „í™˜ìœ¨ ìµœì í™”</h3>
                        <div style="margin-bottom: 12px;">
                            <strong style="display: block; margin-bottom: 8px; color: #1a1a1a;">í‰ê·  ì „í™˜ìœ¨</strong>
                            ${Object.entries(conversionRates).map(([path, rate]) => `
                                <div style="font-size: 0.85em; color: #1a1a1a; margin-bottom: 5px;">
                                    ${getSimplePageName(path)}: <strong>${rate}%</strong>
                                </div>
                            `).join('')}
                        </div>
                        <ul style="list-style: none; margin: 0; padding: 0; color: #1a1a1a; font-size: 0.9em; line-height: 1.7;">
                            <li style="margin-bottom: 8px;">
                                <strong>âœ“ 0.5% ì´ìƒ</strong>: ìƒë‹¨ ê³ ì • + ë°°ì§€
                            </li>
                            <li style="margin-bottom: 8px;">
                                <strong>âœ“ 0.3% ë¯¸ë§Œ</strong>: ìƒí’ˆ í˜ì´ì§€ ê°œì„  í•„ìš”
                            </li>
                        </ul>
                    </div>

                    <!-- ì¬ê³  ê´€ë¦¬ -->
                    <div style="background: linear-gradient(135deg, #fef3c7 0%, #fef9e7 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #f59e0b;">
                        <h3 style="color: #1a1a1a; font-size: 1.1em; margin-bottom: 14px; font-weight: 700;">ğŸ”„ ì¬ê³  ê´€ë¦¬</h3>
                        <strong style="display: block; margin-bottom: 10px; color: #dc2626;">ğŸ”´ ê¸´ê¸‰ ì¬ê³  í™•ë³´</strong>
                        <ul style="list-style: none; margin: 0 0 15px 0; padding: 0; color: #1a1a1a; font-size: 0.85em; line-height: 1.6;">
                            ${highGrowthProducts.slice(0, 3).map(product => `
                                <li style="margin-bottom: 8px;">
                                    ${product.item_name.split(' ').slice(-2).join(' ')}<br>
                                    <span style="color: #6b7280;">êµ¬ë§¤ +${product.purchase_change_rate.toFixed(1)}%</span>
                                </li>
                            `).join('')}
                        </ul>
                        <ul style="list-style: none; margin: 0; padding: 0; color: #1a1a1a; font-size: 0.9em; line-height: 1.7;">
                            <li style="margin-bottom: 8px;">
                                <strong>âœ“ ì¬ê³  10ê°œ ì´í•˜</strong>: "ë§ˆì§€ë§‰ ìˆ˜ëŸ‰" ë°°ì§€
                            </li>
                            <li style="margin-bottom: 8px;">
                                <strong>âœ“ í’ˆì ˆ ì˜ˆìƒ</strong>: ì¬ì…ê³  ì•Œë¦¼ í™œì„±í™”
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- ì‹¤í–‰ ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
                <div style="background: #f8f9ff; border-left: 4px solid #374151; border-radius: 8px; padding: 18px; margin-bottom: 20px;">
                    <h3 style="color: #1a1a1a; margin-bottom: 15px; font-size: 1.1em; font-weight: 700;">âœ… ì£¼ê°„ ì‹¤í–‰ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div>
                            <strong style="color: #1a1a1a; display: block; margin-bottom: 8px;">ğŸ“… ì›”ìš”ì¼</strong>
                            <ul style="color: #6b7280; line-height: 1.7; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                <li>Top 10 ìƒí’ˆ ìˆœìœ„ ì—…ë°ì´íŠ¸</li>
                                <li>ì¬ê³  ìƒíƒœ ì ê²€</li>
                                <li>í”„ë¡œëª¨ì…˜ ì¼ì • ìˆ˜ë¦½</li>
                            </ul>
                        </div>
                        <div>
                            <strong style="color: #1a1a1a; display: block; margin-bottom: 8px;">ğŸ“Š ì¼ì¼ ëª¨ë‹ˆí„°ë§</strong>
                            <ul style="color: #6b7280; line-height: 1.7; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                <li>í˜ì´ì§€ë·°/êµ¬ë§¤ ì´ë²¤íŠ¸ í™•ì¸</li>
                                <li>í’ˆì ˆ ìƒí’ˆ ëŒ€ì²´ ë°°ì¹˜</li>
                                <li>ì¸ê¸° ìƒí’ˆ ì¬ê³  í™•ì¸</li>
                            </ul>
                        </div>
                        <div>
                            <strong style="color: #1a1a1a; display: block; margin-bottom: 8px;">ğŸ¯ ì¦‰ì‹œ ì•¡ì…˜</strong>
                            <ul style="color: #6b7280; line-height: 1.7; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                <li>Top 3 ìƒí’ˆ ìƒë‹¨ ë°°ì¹˜</li>
                                <li>ì „í™˜ìœ¨ 0.5%+ ìƒí’ˆ ë°°ì§€ í‘œì‹œ</li>
                                <li>ì¬ê³  ë¶€ì¡± ìƒí’ˆ ì•Œë¦¼ ì„¤ì •</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- í•µì‹¬ í¬ì¸íŠ¸ ìš”ì•½ -->
                <div style="background: #fee2e2; border-left: 4px solid #dc2626; border-radius: 8px; padding: 18px; margin-bottom: 20px;">
                    <h3 style="color: #dc2626; margin-bottom: 15px; font-size: 1.1em; font-weight: 700;">ğŸ“Œ í•µì‹¬ ê´€ë¦¬ í¬ì¸íŠ¸</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <strong style="color: #1a1a1a; font-size: 0.9em;">1. ìƒí’ˆ ë…¸ì¶œ</strong>
                            <p style="color: #6b7280; font-size: 0.85em; margin: 5px 0 0 0; line-height: 1.5;">
                                select_item + ì „í™˜ìœ¨ ê¸°ì¤€ ë™ì  ì •ë ¬
                            </p>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <strong style="color: #1a1a1a; font-size: 0.9em;">2. ì¬ê³  ê´€ë¦¬</strong>
                            <p style="color: #6b7280; font-size: 0.85em; margin: 5px 0 0 0; line-height: 1.5;">
                                ê¸‰ì¦ ìƒí’ˆ ìš°ì„  í™•ë³´, í’ˆì ˆ ëŒ€ì‘
                            </p>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <strong style="color: #1a1a1a; font-size: 0.9em;">3. ì „í™˜ìœ¨ ê°œì„ </strong>
                            <p style="color: #6b7280; font-size: 0.85em; margin: 5px 0 0 0; line-height: 1.5;">
                                ìƒí’ˆ í˜ì´ì§€ ìµœì í™”, ë¦¬ë·° ê°•í™”
                            </p>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <strong style="color: #1a1a1a; font-size: 0.9em;">4. íŠ¸ë Œë“œ ëŒ€ì‘</strong>
                            <p style="color: #6b7280; font-size: 0.85em; margin: 5px 0 0 0; line-height: 1.5;">
                                ì¼ìë³„ íŒ¨í„´ ë¶„ì„, ì‹¤ì‹œê°„ ëŒ€ì‘
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ì „í™˜ìœ¨ ìµœì í™” ì „ëµ -->
                <div style="background: linear-gradient(135deg, #dcfce7 0%, #d1fae5 100%); border-left: 4px solid #10b981; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                    <h3 style="color: #1a1a1a; margin-bottom: 18px; font-size: 1.2em; font-weight: 700;">ğŸ“ˆ ì „í™˜ìœ¨ ìµœì í™” ì „ëµ</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 20px;">
                        <!-- ì „í™˜ìœ¨ 0.5% ì´ìƒ ìƒí’ˆ ê´€ë¦¬ -->
                        <div style="background: white; padding: 16px; border-radius: 8px;">
                            <h4 style="color: #059669; margin-bottom: 12px; font-size: 1em; font-weight: 700;">âœ… ì „í™˜ìœ¨ 0.5% ì´ìƒ ìƒí’ˆ</h4>
                            <ul style="list-style: none; margin: 0; padding: 0; color: #1a1a1a; font-size: 0.9em; line-height: 1.8;">
                                <li style="margin-bottom: 8px;">âœ“ ìƒë‹¨ ê³ ì • ë°°ì¹˜ (1~3ìˆœìœ„)</li>
                                <li style="margin-bottom: 8px;">âœ“ ì¸ë„¤ì¼ ì´ë¯¸ì§€ ìµœì í™” (ê³ í•´ìƒë„, ë©€í‹°ì•µê¸€)</li>
                                <li style="margin-bottom: 8px;">âœ“ "ì¸ê¸°ìƒí’ˆ" ë°°ì§€ í‘œì‹œ</li>
                                <li style="margin-bottom: 8px;">âœ“ ë¦¬ë·° í‰ì  ë…¸ì¶œ (4.5ì  ì´ìƒ ê°•ì¡°)</li>
                            </ul>
                        </div>

                        <!-- ì „í™˜ìœ¨ 0.3% ë¯¸ë§Œ ìƒí’ˆ ê´€ë¦¬ -->
                        <div style="background: white; padding: 16px; border-radius: 8px;">
                            <h4 style="color: #dc2626; margin-bottom: 12px; font-size: 1em; font-weight: 700;">âš ï¸ ì „í™˜ìœ¨ 0.3% ë¯¸ë§Œ ìƒí’ˆ</h4>
                            <ul style="list-style: none; margin: 0; padding: 0; color: #1a1a1a; font-size: 0.9em; line-height: 1.8;">
                                <li style="margin-bottom: 8px;">âœ“ ìƒí’ˆ í˜ì´ì§€ ê°œì„  í•„ìš”</li>
                                <li style="margin-bottom: 8px;">âœ“ ê°€ê²© ê²½ìŸë ¥ ê²€í† </li>
                                <li style="margin-bottom: 8px;">âœ“ ë¦¬ë·° ë¶€ì¡± ì‹œ ì¸í”Œë£¨ì–¸ì„œ ì²´í—˜ë‹¨ ìš´ì˜</li>
                                <li style="margin-bottom: 8px;">âœ“ ìƒì„¸ ì´ë¯¸ì§€ ë³´ê°•</li>
                            </ul>
                        </div>
                    </div>

                    <!-- êµ¬ë§¤ ì „í™˜ ê°œì„  ì•¡ì…˜ -->
                    <div style="background: white; padding: 18px; border-radius: 8px;">
                        <h4 style="color: #1a1a1a; margin-bottom: 15px; font-size: 1em; font-weight: 700;">ğŸ¯ êµ¬ë§¤ ì „í™˜ ê°œì„  ì•¡ì…˜</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                            <div>
                                <strong style="color: #059669; display: block; margin-bottom: 8px; font-size: 0.95em;">1. CTA ê°•í™”</strong>
                                <ul style="color: #6b7280; line-height: 1.7; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                    <li>"ì§€ê¸ˆ êµ¬ë§¤í•˜ê¸°" ë²„íŠ¼ ìƒ‰ìƒ ëŒ€ë¹„ ê°•í™”</li>
                                    <li>í• ì¸ìœ¨ % í° ê¸€ì”¨ í‘œì‹œ</li>
                                    <li>"ì¬ê³  ë¶€ì¡±" ì•ˆë‚´ë¡œ ê¸´ê¸‰ê° ì¡°ì„±</li>
                                </ul>
                            </div>
                            <div>
                                <strong style="color: #059669; display: block; margin-bottom: 8px; font-size: 0.95em;">2. ì‹ ë¢°ë„ ê°•í™”</strong>
                                <ul style="color: #6b7280; line-height: 1.7; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                    <li>ë¦¬ë·° ìˆ˜ ë…¸ì¶œ (ì˜ˆ: "2,543ëª…ì˜ ë¦¬ë·°")</li>
                                    <li>í‰ê·  í‰ì  ë³„ì  í‘œì‹œ</li>
                                    <li>ë² ìŠ¤íŠ¸ ë¦¬ë·° ìƒë‹¨ ë…¸ì¶œ</li>
                                </ul>
                            </div>
                            <div>
                                <strong style="color: #059669; display: block; margin-bottom: 8px; font-size: 0.95em;">3. ë¹„êµ êµ¬ë§¤ ìœ ë„</strong>
                                <ul style="color: #6b7280; line-height: 1.7; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                    <li>"í•¨ê»˜ êµ¬ë§¤í•˜ë©´ ì¢‹ì€ ìƒí’ˆ" ì„¹ì…˜</li>
                                    <li>ì»¬ëŸ¬ ì˜µì…˜ í™•ëŒ€ (Top 3 ì»¬ëŸ¬ ìš°ì„ )</li>
                                    <li>ì‚¬ì´ì¦ˆ ê°€ì´ë“œ ê°•ì¡°</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì»¬ëŸ¬ë³„ ì „ëµ -->
                <div style="background: linear-gradient(135deg, #fef3c7 0%, #fef9e7 100%); border-left: 4px solid #f59e0b; border-radius: 12px; padding: 20px;">
                    <h3 style="color: #1a1a1a; margin-bottom: 18px; font-size: 1.2em; font-weight: 700;">ğŸ¨ ì»¬ëŸ¬ë³„ ì „ëµ</h3>
                    
                    <!-- ì»¬ëŸ¬ë³„ ì¸ê¸°ë„ ë¶„ì„ -->
                    <div style="background: white; padding: 18px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="color: #d97706; margin-bottom: 15px; font-size: 1em; font-weight: 700;">ğŸ“Š ì¸ê¸° ì»¬ëŸ¬ ë¶„ì„ (select_item ê¸°ì¤€)</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                            ${Object.entries(colorAnalysis).map(([pagePath, colors]) => {
                                const pageName = getSimplePageName(pagePath);
                                
                                // ì»¬ëŸ¬ë³„ ë°ì´í„° ì •ë ¬ (select_item ê¸°ì¤€)
                                const sortedColors = Object.entries(colors)
                                    .map(([colorCode, data]) => {
                                        const conversion = data.view_count > 0 ? (data.purchase_count / data.view_count * 100) : 0;
                                        return {
                                            colorCode: colorCode,
                                            selectCount: data.select_count || 0,
                                            viewCount: data.view_count,
                                            purchaseCount: data.purchase_count,
                                            conversionRate: conversion
                                        };
                                    })
                                    .sort((a, b) => b.selectCount - a.selectCount)
                                    .slice(0, 3);

                                const colorNames = {
                                    "BKS": "ë¸”ë™",
                                    "BKN": "ë¸Œë¼ìš´",
                                    "CRN": "í¬ë¦¼",
                                    "CRS": "í¬ë¦¼",
                                    "BES": "ë² ì´ì§€",
                                    "GRD": "ê·¸ë ˆì´",
                                    "BKL": "ë¸”ë™"
                                };

                                return `
                                    <div>
                                        <strong style="color: #1a1a1a; display: block; margin-bottom: 10px; font-size: 0.95em;">${pageName}</strong>
                                        <ul style="list-style: none; margin: 0; padding: 0; color: #1a1a1a; font-size: 0.9em; line-height: 1.8;">
                                            ${sortedColors.map((color, idx) => {
                                                const colorName = colorNames[color.colorCode] || color.colorCode;
                                                let insight = '';
                                                if (idx === 0 && color.selectCount > 1500) {
                                                    insight = 'â†’ ì ˆëŒ€ì  ì„ í˜¸, ì¬ê³  ìµœìš°ì„  í™•ë³´';
                                                } else if (color.conversionRate > 0.5) {
                                                    insight = 'â†’ ë†’ì€ ì „í™˜ìœ¨, ìƒë‹¨ ë°°ì¹˜ ê¶Œì¥';
                                                } else if (color.conversionRate < 0.3 && color.conversionRate > 0) {
                                                    insight = 'â†’ ë§ˆì¼€íŒ… ê°•í™” í•„ìš”';
                                                } else if (color.selectCount > 0) {
                                                    insight = 'â†’ ì•ˆì •ì  ì„±ê³¼';
                                                } else {
                                                    insight = 'â†’ ëª¨ë‹ˆí„°ë§ í•„ìš”';
                                                }
                                                
                                                return `
                                                    <li style="margin-bottom: 8px;">
                                                        <strong style="color: #1a1a1a;">${color.colorCode} (${colorName})</strong>
                                                        ${color.selectCount > 0 ? `: select_item ${color.selectCount.toLocaleString()}íšŒ` : ''}
                                                        ${color.conversionRate > 0 ? ` (ì „í™˜ìœ¨ ${color.conversionRate.toFixed(2)}%)` : ''}
                                                        <br>
                                                        <span style="color: #6b7280; font-size: 0.85em;">${insight}</span>
                                                    </li>
                                                `;
                                            }).join('')}
                                        </ul>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <!-- ì»¬ëŸ¬ë³„ ê´€ë¦¬ í¬ì¸íŠ¸ -->
                    <div style="background: white; padding: 18px; border-radius: 8px;">
                        <h4 style="color: #d97706; margin-bottom: 15px; font-size: 1em; font-weight: 700;">ğŸ¯ ì»¬ëŸ¬ë³„ ê´€ë¦¬ í¬ì¸íŠ¸</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                            <div>
                                <strong style="color: #1a1a1a; display: block; margin-bottom: 8px; font-size: 0.95em;">âœ“ ì»¬ëŸ¬ë³„ ë…¸ì¶œ ë¹„ìœ¨ ì¡°ì •</strong>
                                <ul style="color: #6b7280; line-height: 1.7; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                    <li>BKS: 40~50% (ì ˆëŒ€ ì„ í˜¸)</li>
                                    <li>BKN: 25~30% (2ìˆœìœ„)</li>
                                    <li>ê¸°íƒ€ ì»¬ëŸ¬: 20~35% (ê· í˜•)</li>
                                </ul>
                            </div>
                            <div>
                                <strong style="color: #1a1a1a; display: block; margin-bottom: 8px; font-size: 0.95em;">âœ“ ì»¬ëŸ¬ í•„í„° ê¸°ëŠ¥</strong>
                                <ul style="color: #6b7280; line-height: 1.7; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                    <li>ìƒë‹¨ í•„í„°ì— "ì¸ê¸° ì»¬ëŸ¬" ê°•ì¡°</li>
                                    <li>ì»¬ëŸ¬ë³„ ì¬ê³  ìƒíƒœ í‘œì‹œ</li>
                                    <li>ì»¬ëŸ¬ë³„ ê°€ê²© ì°¨ì´ ëª…í™•íˆ í‘œì‹œ</li>
                                </ul>
                            </div>
                            <div>
                                <strong style="color: #1a1a1a; display: block; margin-bottom: 8px; font-size: 0.95em;">âœ“ ì»¬ëŸ¬ë³„ ë°°ì¹˜ ì „ëµ</strong>
                                <ul style="color: #6b7280; line-height: 1.7; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                    <li>BKS ì»¬ëŸ¬ ìƒí’ˆ ìƒë‹¨ ìš°ì„  ë°°ì¹˜</li>
                                    <li>ì¸ê¸° ì»¬ëŸ¬ë³„ ê·¸ë£¹í•‘ í‘œì‹œ</li>
                                    <li>ì €ì¡°í•œ ì»¬ëŸ¬ëŠ” í•˜ë‹¨ ë°°ì¹˜</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            container.innerHTML = html;
        }

        // Top 3 í˜ì´ì§€ë³„ íŠ¹ì§• ë° ê°œì„ ì‚¬í•­ ë Œë”ë§ í•¨ìˆ˜
        function renderTop3PagesAnalysis() {
            const container = document.getElementById('top3PagesAnalysisContainer');
            if (!container) return;

            // Top 3 í˜ì´ì§€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const top3Pages = pageData.slice(0, 3);
            
            // ê° í˜ì´ì§€ë³„ ì „í™˜ìœ¨ ë° ì¶”ê°€ ì •ë³´ ê³„ì‚°
            const top3PagesAnalysis = top3Pages.map(page => {
                const conversionRate = page.page_views > 0 ? (page.purchase_count / page.page_views * 100) : 0;
                const pvPerVisitor = page.unique_visitors > 0 ? (page.page_views / page.unique_visitors) : 0;
                
                // ìƒí’ˆ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const products = dxmbPageProductsData[page.page_path] || [];
                const topProduct = products.length > 0 ? products[0] : null;
                
                // ì»¬ëŸ¬ ë¶„ì„ (ìƒí’ˆ ì¡°íšŒìˆ˜ ê¸°ì¤€)
                const colorData = {};
                products.forEach(product => {
                    const colorMatch = product.item_id.match(/-([A-Z]+)$/);
                    if (colorMatch) {
                        const colorCode = colorMatch[1];
                        if (!colorData[colorCode]) {
                            colorData[colorCode] = { view_count: 0, purchase_count: 0 };
                        }
                        colorData[colorCode].view_count += product.view_count || 0;
                        colorData[colorCode].purchase_count += product.purchase_count;
                    }
                });
                
                const topColor = Object.entries(colorData)
                    .sort((a, b) => b[1].view_count - a[1].view_count)[0];

                return {
                    ...page,
                    conversionRate: conversionRate,
                    pvPerVisitor: pvPerVisitor,
                    topProduct: topProduct,
                    topColor: topColor ? { code: topColor[0], count: topColor[1].view_count } : null,
                    products: products
                };
            });

            let html = '';
            
            top3PagesAnalysis.forEach((page, idx) => {
                const rankEmoji = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'][idx];
                const rankText = ['1ìœ„', '2ìœ„', '3ìœ„'][idx];
                const rankColor = ['#dc2626', '#f59e0b', '#3b82f6'][idx];
                
                // ìƒí’ˆ ë°°ì¹˜ ì¶”ì²œ ìƒì„±
                const productPlacements = [];
                
                // ìƒí’ˆ ì¡°íšŒìˆ˜ ë°ì´í„°ì™€ ìƒí’ˆ ë°ì´í„°ë¥¼ ê²°í•© (select_item + view_item í•©ì‚°)
                const productsWithSelect = page.products.map(product => {
                    const conversionRate = product.view_count > 0 ? (product.purchase_count / product.view_count * 100) : 0;
                    const colorMatch = product.item_id.match(/-([A-Z]+)$/);
                    const colorCode = colorMatch ? colorMatch[1] : '';
                    
                    return {
                        ...product,
                        view_count: product.view_count || 0, // ìƒí’ˆ ì¡°íšŒìˆ˜ (select_item + view_item í•©ì‚°)
                        conversionRate: conversionRate,
                        colorCode: colorCode
                    };
                }).sort((a, b) => {
                    // ë°°ì¹˜ ìš°ì„ ìˆœìœ„: ìƒí’ˆ ì¡°íšŒìˆ˜ + ì „í™˜ìœ¨ ê°€ì¤‘ì¹˜
                    const scoreA = a.view_count + (a.conversionRate * 100);
                    const scoreB = b.view_count + (b.conversionRate * 100);
                    return scoreB - scoreA;
                });

                // Top 5 ìƒí’ˆ ë°°ì¹˜ ì¶”ì²œ
                productsWithSelect.slice(0, 5).forEach((product, idx) => {
                    let placement = '';
                    let reason = '';
                    
                    if (idx === 0) {
                        placement = '1ìˆœìœ„: í˜ì´ì§€ ìƒë‹¨ ìµœìš°ì„  ë°°ì¹˜';
                        reason = `ìƒí’ˆ ì¡°íšŒìˆ˜ ${product.view_count.toLocaleString()}íšŒ, ì „í™˜ìœ¨ ${product.conversionRate.toFixed(2)}%`;
                    } else if (idx === 1) {
                        placement = '2ìˆœìœ„: ìƒë‹¨ ì£¼ìš” ì˜ì—­ ë°°ì¹˜';
                        reason = `ìƒí’ˆ ì¡°íšŒìˆ˜ ${product.view_count.toLocaleString()}íšŒ, ì „í™˜ìœ¨ ${product.conversionRate.toFixed(2)}%`;
                    } else if (idx === 2) {
                        placement = '3ìˆœìœ„: ìƒë‹¨ ë³´ì¡° ì˜ì—­ ë°°ì¹˜';
                        reason = `ìƒí’ˆ ì¡°íšŒìˆ˜ ${product.view_count.toLocaleString()}íšŒ, ì „í™˜ìœ¨ ${product.conversionRate.toFixed(2)}%`;
                    } else {
                        placement = `${idx + 1}ìˆœìœ„: ì¤‘ê°„ ì˜ì—­ ë°°ì¹˜`;
                        reason = `ìƒí’ˆ ì¡°íšŒìˆ˜ ${product.view_count.toLocaleString()}íšŒ, ì „í™˜ìœ¨ ${product.conversionRate.toFixed(2)}%`;
                    }
                    
                    productPlacements.push({
                        rank: idx + 1,
                        placement: placement,
                        productName: product.item_name,
                        productId: product.item_id,
                        reason: reason,
                        viewCount: product.view_count,
                        conversionRate: product.conversionRate,
                        colorCode: product.colorCode,
                        purchaseChangeRate: product.purchase_change_rate
                    });
                });

                html += `
                    <div style="background: linear-gradient(135deg, ${idx === 0 ? '#fee2e2' : idx === 1 ? '#fef3c7' : '#dbeafe'} 0%, ${idx === 0 ? '#fecaca' : idx === 1 ? '#fde68a' : '#bfdbfe'} 100%); border-left: 5px solid ${rankColor}; border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                        <div style="display: flex; align-items: center; margin-bottom: 20px;">
                            <span style="font-size: 2em; margin-right: 10px;">${rankEmoji}</span>
                            <div>
                                <h3 style="color: #1a1a1a; font-size: 1.3em; font-weight: 700; margin: 0;">
                                    ${rankText}: ${getSimplePageName(page.page_path)}
                                </h3>
                                <p style="color: #6b7280; font-size: 0.9em; margin: 5px 0 0 0;">${page.page_path}</p>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                            <div style="background: white; padding: 18px; border-radius: 8px;">
                                <h4 style="color: #059669; margin-bottom: 12px; font-size: 1em; font-weight: 700;">âœ¨ ì£¼ìš” íŠ¹ì§•</h4>
                                <ul style="list-style: none; margin: 0; padding: 0; color: #1a1a1a; font-size: 0.9em; line-height: 1.8;">
                                    ${idx === 0 ? `
                                        <li style="margin-bottom: 8px;">âœ“ <strong>ìµœê³  ìœ ì…ëŸ‰ í˜ì´ì§€</strong> - DXMB ì¹´í…Œê³ ë¦¬ ì¤‘ 1ìœ„</li>
                                        <li style="margin-bottom: 8px;">âœ“ <strong>ìƒí’ˆ ì¸ê¸°ë„ ë§¤ìš° ë†’ìŒ</strong> - Top ìƒí’ˆ ì¡°íšŒìˆ˜ ${page.topProduct ? page.topProduct.view_count.toLocaleString() : '0'}íšŒ</li>
                                        <li style="margin-bottom: 8px;">âœ“ <strong>ì»¬ëŸ¬ ì„ í˜¸ë„ ëª…í™•</strong> - BKS ì»¬ëŸ¬ ì ˆëŒ€ì  ì„ í˜¸</li>
                                    ` : idx === 1 ? `
                                        <li style="margin-bottom: 8px;">âœ“ <strong>ìµœê³  ì¦ê°€ìœ¨</strong> - í˜ì´ì§€ ì¡°íšŒìˆ˜ +${page.page_views_change_rate.toFixed(1)}%</li>
                                        <li style="margin-bottom: 8px;">âœ“ <strong>ë†’ì€ ì „í™˜ìœ¨ ìƒí’ˆ ë³´ìœ </strong> - ë°˜ìŠ¬ë¦¬ ë‹¤ìš´ ì „í™˜ìœ¨ 0.74%</li>
                                        <li style="margin-bottom: 8px;">âœ“ <strong>ì•ˆì •ì ì¸ ìƒí’ˆ ë¼ì¸ì—…</strong> - Top 3 ìƒí’ˆ ê· í˜•ì  ë¶„í¬</li>
                                        <li style="margin-bottom: 8px;">âœ“ <strong>BKS ì»¬ëŸ¬ ê°•ì„¸</strong> - Top 3 ìƒí’ˆ ëª¨ë‘ BKS</li>
                                    ` : `
                                        <li style="margin-bottom: 8px;">âœ“ <strong>ìµœê³  ì „í™˜ìœ¨</strong> - ${page.conversionRate.toFixed(2)}% (Top 3 ì¤‘ ìµœê³ )</li>
                                        <li style="margin-bottom: 8px;">âœ“ <strong>í•µì‹¬ ìƒí’ˆ ëª…í™•</strong> - ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ì „í™˜ìœ¨ 1.07%</li>
                                        <li style="margin-bottom: 8px;">âœ“ <strong>ì»¬ëŸ¬ ë‹¤ì–‘ì„±</strong> - BKS, BES, BKN ë“± ë‹¤ì–‘í•œ ì„ í˜¸</li>
                                        <li style="margin-bottom: 8px;">âœ“ <strong>ìœ ë‹ˆì„¹ìŠ¤ ìƒí’ˆ ì¸ê¸°</strong> - ìœ ë‹ˆ ë°˜ìŠ¬ë¦¬ ê¸‰ì„±ì¥</li>
                                    `}
                                </ul>
                            </div>

                            <div style="background: white; padding: 18px; border-radius: 8px;">
                                <h4 style="color: ${rankColor}; margin-bottom: 10px; font-size: 1em; font-weight: 700;">ğŸ“‹ ì¶”ì²œ ìƒí’ˆ ë°°ì¹˜ ì „ëµ</h4>
                                <div style="color: #1a1a1a; font-size: 0.9em; line-height: 1.5;">
                                    ${productPlacements.slice(0, 3).map((placement, pIdx) => `
                                        <div style="margin-bottom: 8px; padding: 8px; background: ${pIdx < 3 ? '#f0fdf4' : '#f9fafb'}; border-radius: 6px; border-left: 3px solid ${pIdx === 0 ? '#10b981' : pIdx === 1 ? '#3b82f6' : '#f59e0b'};">
                                            <div style="font-weight: 700; color: #1a1a1a; margin-bottom: 3px; font-size: 0.95em;">
                                                ${placement.rank}. ${placement.productName} <span style="color: #6b7280; font-size: 0.75em; font-family: monospace; background: #f3f4f6; padding: 2px 6px; border-radius: 3px; font-weight: 500; margin-left: 8px;">${placement.productId}</span>
                                            </div>
                                            <div style="color: #6b7280; font-size: 0.85em;">
                                                ${placement.placement} | ${placement.reason}
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë Œë”ë§ (getSimplePageName í•¨ìˆ˜ëŠ” ì´ë¯¸ ìœ„ì—ì„œ ì •ì˜ë¨)
        document.addEventListener('DOMContentLoaded', function() {
            renderInsights();
            renderDxmbProducts();
            renderTop3PagesAnalysis();
        });
    </script>
</body>
</html>
