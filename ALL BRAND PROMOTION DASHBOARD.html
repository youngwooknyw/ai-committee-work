<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸°íšì „ ìŠ¤í¬ë¡¤ ëìŠ¤ ë¶„ì„ ëŒ€ì‹œë³´ë“œ (Snowflake)</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', 'Segoe UI', sans-serif;
            background: #ffffff;
            padding: 30px;
            color: #1a1a1a;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: #ffffff;
            padding: 30px;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            margin-bottom: 30px;
            text-align: center;
            border: 1px solid #e5e7eb;
        }

        .header h1 {
            color: #1a1a1a;
            font-size: 2.4em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .table-container {
            background: #ffffff;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            overflow-x: auto;
            border: 1px solid #e5e7eb;
            margin-bottom: 30px;
        }

        .table-container h2 {
            color: #1a1a1a;
            font-size: 1.5em;
            margin-bottom: 18px;
            font-weight: 700;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        th {
            background: #f8f9ff;
            font-weight: 600;
            color: #1a1a1a;
        }

        tr:hover {
            background: #f9fafb;
        }

        .chart-container {
            background: #ffffff;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            border: 1px solid #e5e7eb;
            margin-bottom: 30px;
        }

        .chart-container h2 {
            color: #1a1a1a;
            font-size: 1.5em;
            margin-bottom: 24px;
            font-weight: 700;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
        }

        .insights-container {
            background: #ffffff;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            border: 1px solid #e5e7eb;
            margin-bottom: 30px;
        }

        .insights-container h2 {
            color: #1a1a1a;
            font-size: 1.5em;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .insight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .insight-card {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .insight-card.excellent {
            background: #dcfce7;
            border-left-color: #22c55e;
        }

        .insight-card.warning {
            background: #fef3c7;
            border-left-color: #f59e0b;
        }

        .insight-card.alert {
            background: #fee2e2;
            border-left-color: #ef4444;
        }

        .insight-card h3 {
            color: #1a1a1a;
            font-size: 1.1em;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .insight-card ul {
            list-style: none;
            padding: 0;
        }

        .insight-card li {
            color: #374151;
            font-size: 0.95em;
            line-height: 1.6;
            margin-bottom: 8px;
            padding-left: 8px;
        }

        .insight-card strong {
            color: #1a1a1a;
            font-weight: 600;
        }

        /* íƒ­ ìŠ¤íƒ€ì¼ */
        .tabs {
            background: #ffffff;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            margin-bottom: 30px;
            border: 1px solid #e5e7eb;
            overflow: hidden;
        }

        .tab-buttons {
            display: flex;
            background: #f8f9ff;
        }

        .tab-button {
            flex: 1;
            padding: 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            color: #6b7280;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            font-family: 'Pretendard', 'Segoe UI', sans-serif;
        }

        .tab-button:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .tab-button.active {
            color: #667eea;
            background: #ffffff;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ê¸°íšì „ ëŒ€ì‹œë³´ë“œ</h1>
            <p style="color:#6b7280; font-weight:500;">ê¸°ê°„: 2025ë…„ 12ì›” 29ì¼ ~ 2026ë…„ 1ì›” 4ì¼</p>
        </div>

        <!-- íƒ­ -->
        <div class="tabs">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="switchTab('X')">
                    ğŸ”µ ë””ìŠ¤ì»¤ë²„ë¦¬ (X)
                </button>
                <button class="tab-button" onclick="switchTab('M')">
                    âš¾ MLB (M)
                </button>
                <button class="tab-button" onclick="switchTab('V')">
                    ğŸ§¥ ë“€ë² í‹°ì¹´ (V)
                </button>
                <button class="tab-button" onclick="switchTab('ST')">
                    ğŸ·ï¸ ST (ST)
                </button>
            </div>
        </div>

        <!-- X ë¸Œëœë“œ (ë””ìŠ¤ì»¤ë²„ë¦¬) íƒ­ -->
        <div id="tab-X" class="tab-content active">
            <div class="insights-container">
                <h2>ğŸ’¡ í•µì‹¬ ì¸ì‚¬ì´íŠ¸</h2>
                <div id="insightsContentX"></div>
            </div>

            <div class="table-container">
                <h2>ğŸ† TOP 5 ê¸°íšì „ ìŠ¤í¬ë¡¤ ëìŠ¤ í†µê³„</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>ê¸°íšì „ ë²ˆí˜¸</th>
                            <th>í˜ì´ì§€ë·°</th>
                            <th>25% ë„ë‹¬</th>
                            <th>50% ë„ë‹¬</th>
                            <th>75% ë„ë‹¬</th>
                            <th>95% ë„ë‹¬</th>
                            <th>ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸</th>
                            <th>95% ë„ë‹¬ë¥ </th>
                        </tr>
                    </thead>
                    <tbody id="scrollDepthTableBodyX"></tbody>
                </table>
            </div>

            <div class="chart-container">
                <h2>ğŸ“Š TOP 5 ê¸°íšì „ë³„ ìŠ¤í¬ë¡¤ ëìŠ¤ ë¹„êµ ì°¨íŠ¸</h2>
                <div class="chart-wrapper">
                    <canvas id="scrollDepthChartX"></canvas>
                </div>
            </div>

            <div class="table-container">
                <h2>ğŸ“ˆ ê¸°íšì „ í˜ì´ì§€ë³„ ì„±ê³¼</h2>
                <p style="color:#6b7280; font-size:0.95em; margin-bottom:18px; line-height:1.6;">
                    âœ… "ê¸°íšì „ í˜ì´ì§€ë¥¼ í•œ ë²ˆì´ë¼ë„ ë³¸ ì„¸ì…˜"ì„ ê¸°ì¤€ìœ¼ë¡œ ê·¸ ë°œìƒí•œ ì´ë²¤íŠ¸ ìˆ˜ë¥¼ ê¸°íšì „ì— ê·€ì†
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>ê¸°íšì „ ë²ˆí˜¸</th>
                            <th>í˜ì´ì§€ë·°</th>
                            <th>ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸</th>
                            <th>êµ¬ë§¤ ì´ë²¤íŠ¸</th>
                            <th>êµ¬ë§¤ ì „í™˜ìœ¨</th>
                            <th>ë§¤ì¶œ</th>
                        </tr>
                    </thead>
                    <tbody id="performanceTableBodyX"></tbody>
                </table>
            </div>

            <div class="table-container">
                <h2>ğŸ›ï¸ ê¸°íšì „ë³„ ìƒí’ˆ ì„±ê³¼</h2>
                <div id="productsPerformanceContainerX"></div>
            </div>
        </div>

        <!-- M ë¸Œëœë“œ (MLB) íƒ­ -->
        <div id="tab-M" class="tab-content">
            <div class="insights-container">
                <h2>ğŸ’¡ í•µì‹¬ ì¸ì‚¬ì´íŠ¸</h2>
                <div id="insightsContentM"></div>
            </div>

            <div class="table-container">
                <h2>ğŸ† TOP 5 ê¸°íšì „ ìŠ¤í¬ë¡¤ ëìŠ¤ í†µê³„</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>ê¸°íšì „ ë²ˆí˜¸</th>
                            <th>í˜ì´ì§€ë·°</th>
                            <th>25% ë„ë‹¬</th>
                            <th>50% ë„ë‹¬</th>
                            <th>75% ë„ë‹¬</th>
                            <th>95% ë„ë‹¬</th>
                            <th>ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸</th>
                            <th>95% ë„ë‹¬ë¥ </th>
                        </tr>
                    </thead>
                    <tbody id="scrollDepthTableBodyM"></tbody>
                </table>
            </div>

            <div class="chart-container">
                <h2>ğŸ“Š TOP 5 ê¸°íšì „ë³„ ìŠ¤í¬ë¡¤ ëìŠ¤ ë¹„êµ ì°¨íŠ¸</h2>
                <div class="chart-wrapper">
                    <canvas id="scrollDepthChartM"></canvas>
                </div>
            </div>

            <div class="table-container">
                <h2>ğŸ“ˆ ê¸°íšì „ í˜ì´ì§€ë³„ ì„±ê³¼</h2>
                <p style="color:#6b7280; font-size:0.95em; margin-bottom:18px; line-height:1.6;">
                    âœ… "ê¸°íšì „ í˜ì´ì§€ë¥¼ í•œ ë²ˆì´ë¼ë„ ë³¸ ì„¸ì…˜"ì„ ê¸°ì¤€ìœ¼ë¡œ ê·¸ ë°œìƒí•œ ì´ë²¤íŠ¸ ìˆ˜ë¥¼ ê¸°íšì „ì— ê·€ì†
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>ê¸°íšì „ ë²ˆí˜¸</th>
                            <th>í˜ì´ì§€ë·°</th>
                            <th>ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸</th>
                            <th>êµ¬ë§¤ ì´ë²¤íŠ¸</th>
                            <th>êµ¬ë§¤ ì „í™˜ìœ¨</th>
                            <th>ë§¤ì¶œ</th>
                        </tr>
                    </thead>
                    <tbody id="performanceTableBodyM"></tbody>
                </table>
            </div>

            <div class="table-container">
                <h2>ğŸ›ï¸ ê¸°íšì „ë³„ ìƒí’ˆ ì„±ê³¼</h2>
                <div id="productsPerformanceContainerM"></div>
            </div>
        </div>

        <!-- V ë¸Œëœë“œ (ë“€ë² í‹°ì¹´) íƒ­ -->
        <div id="tab-V" class="tab-content">
            <div class="insights-container">
                <h2>ğŸ’¡ í•µì‹¬ ì¸ì‚¬ì´íŠ¸</h2>
                <div id="insightsContentV"></div>
            </div>

            <div class="table-container">
                <h2>ğŸ† TOP 5 ê¸°íšì „ ìŠ¤í¬ë¡¤ ëìŠ¤ í†µê³„</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>ê¸°íšì „ ë²ˆí˜¸</th>
                            <th>í˜ì´ì§€ë·°</th>
                            <th>25% ë„ë‹¬</th>
                            <th>50% ë„ë‹¬</th>
                            <th>75% ë„ë‹¬</th>
                            <th>95% ë„ë‹¬</th>
                            <th>ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸</th>
                            <th>95% ë„ë‹¬ë¥ </th>
                        </tr>
                    </thead>
                    <tbody id="scrollDepthTableBodyV"></tbody>
                </table>
            </div>

            <div class="chart-container">
                <h2>ğŸ“Š TOP 5 ê¸°íšì „ë³„ ìŠ¤í¬ë¡¤ ëìŠ¤ ë¹„êµ ì°¨íŠ¸</h2>
                <div class="chart-wrapper">
                    <canvas id="scrollDepthChartV"></canvas>
                </div>
            </div>

            <div class="table-container">
                <h2>ğŸ“ˆ ê¸°íšì „ í˜ì´ì§€ë³„ ì„±ê³¼</h2>
                <p style="color:#6b7280; font-size:0.95em; margin-bottom:18px; line-height:1.6;">
                    âœ… "ê¸°íšì „ í˜ì´ì§€ë¥¼ í•œ ë²ˆì´ë¼ë„ ë³¸ ì„¸ì…˜"ì„ ê¸°ì¤€ìœ¼ë¡œ ê·¸ ë°œìƒí•œ ì´ë²¤íŠ¸ ìˆ˜ë¥¼ ê¸°íšì „ì— ê·€ì†
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>ê¸°íšì „ ë²ˆí˜¸</th>
                            <th>í˜ì´ì§€ë·°</th>
                            <th>ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸</th>
                            <th>êµ¬ë§¤ ì´ë²¤íŠ¸</th>
                            <th>êµ¬ë§¤ ì „í™˜ìœ¨</th>
                            <th>ë§¤ì¶œ</th>
                        </tr>
                    </thead>
                    <tbody id="performanceTableBodyV"></tbody>
                </table>
            </div>

            <div class="table-container">
                <h2>ğŸ›ï¸ ê¸°íšì „ë³„ ìƒí’ˆ ì„±ê³¼</h2>
                <div id="productsPerformanceContainerV"></div>
            </div>
        </div>

        <!-- ST ë¸Œëœë“œ íƒ­ -->
        <div id="tab-ST" class="tab-content">
            <div class="insights-container">
                <h2>ğŸ’¡ í•µì‹¬ ì¸ì‚¬ì´íŠ¸</h2>
                <div id="insightsContentST"></div>
            </div>

            <div class="table-container">
                <h2>ğŸ† TOP 5 ê¸°íšì „ ìŠ¤í¬ë¡¤ ëìŠ¤ í†µê³„</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>ê¸°íšì „ ë²ˆí˜¸</th>
                            <th>í˜ì´ì§€ë·°</th>
                            <th>25% ë„ë‹¬</th>
                            <th>50% ë„ë‹¬</th>
                            <th>75% ë„ë‹¬</th>
                            <th>95% ë„ë‹¬</th>
                            <th>ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸</th>
                            <th>95% ë„ë‹¬ë¥ </th>
                        </tr>
                    </thead>
                    <tbody id="scrollDepthTableBodyST"></tbody>
                </table>
            </div>

            <div class="chart-container">
                <h2>ğŸ“Š TOP 5 ê¸°íšì „ë³„ ìŠ¤í¬ë¡¤ ëìŠ¤ ë¹„êµ ì°¨íŠ¸</h2>
                <div class="chart-wrapper">
                    <canvas id="scrollDepthChartST"></canvas>
                </div>
            </div>

            <div class="table-container">
                <h2>ğŸ“ˆ ê¸°íšì „ í˜ì´ì§€ë³„ ì„±ê³¼</h2>
                <p style="color:#6b7280; font-size:0.95em; margin-bottom:18px; line-height:1.6;">
                    âœ… "ê¸°íšì „ í˜ì´ì§€ë¥¼ í•œ ë²ˆì´ë¼ë„ ë³¸ ì„¸ì…˜"ì„ ê¸°ì¤€ìœ¼ë¡œ ê·¸ ë°œìƒí•œ ì´ë²¤íŠ¸ ìˆ˜ë¥¼ ê¸°íšì „ì— ê·€ì†
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>ìˆœìœ„</th>
                            <th>ê¸°íšì „ ë²ˆí˜¸</th>
                            <th>í˜ì´ì§€ë·°</th>
                            <th>ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸</th>
                            <th>êµ¬ë§¤ ì´ë²¤íŠ¸</th>
                            <th>êµ¬ë§¤ ì „í™˜ìœ¨</th>
                            <th>ë§¤ì¶œ</th>
                        </tr>
                    </thead>
                    <tbody id="performanceTableBodyST"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const scrollDepthDataX = [
            {
                        "promotion_number": "1581",
                        "promotion_name": "ê¸°íšì „ #1581",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - 26SS ë¼ì´í¬ ì—ì–´ ë°±íŒ© ì‹œë¦¬ì¦ˆ",
                        "page_views": 54214,
                        "depth_25": 9797,
                        "depth_50": 3671,
                        "depth_75": 1915,
                        "depth_95": 1242,
                        "total_events": 16625
            },
            {
                        "promotion_number": "1593",
                        "promotion_name": "ê¸°íšì „ #1593",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ì›€ì§ì„ê¹Œì§€ ê°€ë²¼ìš´ ë°±íŒ© Like-Air",
                        "page_views": 45870,
                        "depth_25": 6268,
                        "depth_50": 3389,
                        "depth_75": 2196,
                        "depth_95": 1572,
                        "total_events": 13425
            },
            {
                        "promotion_number": "1514",
                        "promotion_name": "ê¸°íšì „ #1514",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - í”„ë¦¬ë¯¸ì—„ ë¼ì´í”„ìŠ¤íƒ€ì¼ì„ ìœ„í•œ ë ˆìŠ¤í„°G",
                        "page_views": 36020,
                        "depth_25": 9037,
                        "depth_50": 4299,
                        "depth_75": 2460,
                        "depth_95": 1687,
                        "total_events": 17483
            },
            {
                        "promotion_number": "1582",
                        "promotion_name": "ê¸°íšì „ #1582",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - Ready for School ë‘ê·¼ë‘ê·¼ ì…í•™, ì²« ì±…ê°€ë°©ì„ ë§Œë‚˜ëŠ” ìˆœê°„",
                        "page_views": 15776,
                        "depth_25": 3108,
                        "depth_50": 2506,
                        "depth_75": 1380,
                        "depth_95": 763,
                        "total_events": 7757
            },
            {
                        "promotion_number": "1512",
                        "promotion_name": "ê¸°íšì „ #1512",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ê²¨ìš¸ ìŠ¤íƒ€ì¼ì„ ì™„ì„±í•˜ëŠ” ìœˆí„° ë¶€ì¸ ",
                        "page_views": 15440,
                        "depth_25": 2997,
                        "depth_50": 1956,
                        "depth_75": 1297,
                        "depth_95": 913,
                        "total_events": 7163
            }
];
        const scrollDepthDataM = [
            {
                        "promotion_number": "1520",
                        "promotion_name": "ê¸°íšì „ #1520",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - ì¹´ë¦¬ë‚˜ì˜ ê²¨ìš¸ ì‹¤ë£¨ì—£ CURVE THE WINTER",
                        "page_views": 92756,
                        "depth_25": 5403,
                        "depth_50": 4114,
                        "depth_75": 3487,
                        "depth_95": 3346,
                        "total_events": 16350
            },
            {
                        "promotion_number": "1571",
                        "promotion_name": "ê¸°íšì „ #1571",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - LITE ON, MOVE ON! MLB KIDS ì‹ í•™ê¸° ì±…ê°€ë°©",
                        "page_views": 23558,
                        "depth_25": 3735,
                        "depth_50": 2241,
                        "depth_75": 1354,
                        "depth_95": 1088,
                        "total_events": 8418
            },
            {
                        "promotion_number": "1557",
                        "promotion_name": "ê¸°íšì „ #1557",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - KARINA & TWS PICK MLB ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ",
                        "page_views": 23120,
                        "depth_25": 2967,
                        "depth_50": 2037,
                        "depth_75": 1561,
                        "depth_95": 1228,
                        "total_events": 7793
            },
            {
                        "promotion_number": "1570",
                        "promotion_name": "ê¸°íšì „ #1570",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - WINTERâ€™S HEAT WAVE SHOES COLLECTION",
                        "page_views": 21700,
                        "depth_25": 4811,
                        "depth_50": 3732,
                        "depth_75": 2616,
                        "depth_95": 1335,
                        "total_events": 12494
            },
            {
                        "promotion_number": "1585",
                        "promotion_name": "ê¸°íšì „ #1585",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - ì°¨ê°€ìš´ ê²¨ìš¸ì— ë‹¿ëŠ” ë”°ëœ»í•œ í˜œíƒ DEEP WINTER FESTA",
                        "page_views": 5826,
                        "depth_25": 1130,
                        "depth_50": 802,
                        "depth_75": 501,
                        "depth_95": 355,
                        "total_events": 2788
            }
];
        const scrollDepthDataV = [
            {
                        "promotion_number": "1555",
                        "promotion_name": "ê¸°íšì „ #1555",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - DUVETICA with Kim Jiwon - COLLECTION",
                        "page_views": 45036,
                        "depth_25": 7646,
                        "depth_50": 3082,
                        "depth_75": 2321,
                        "depth_95": 1903,
                        "total_events": 14952
            },
            {
                        "promotion_number": "1587",
                        "promotion_name": "ê¸°íšì „ #1587",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - WINTER MOMENT with Ki Eunse - COLLECTION",
                        "page_views": 26170,
                        "depth_25": 7253,
                        "depth_50": 3672,
                        "depth_75": 2035,
                        "depth_95": 1235,
                        "total_events": 14195
            },
            {
                        "promotion_number": "1586",
                        "promotion_name": "ê¸°íšì „ #1586",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - WARMTH IN THE FREEZE - COLLECTION",
                        "page_views": 16262,
                        "depth_25": 4250,
                        "depth_50": 2120,
                        "depth_75": 1068,
                        "depth_95": 668,
                        "total_events": 8106
            },
            {
                        "promotion_number": "1545",
                        "promotion_name": "ê¸°íšì „ #1545",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - THE SIGNATURE TEXTURES - COLLECTION",
                        "page_views": 5416,
                        "depth_25": 1555,
                        "depth_50": 1269,
                        "depth_75": 767,
                        "depth_95": 537,
                        "total_events": 4128
            },
            {
                        "promotion_number": "1479",
                        "promotion_name": "ê¸°íšì „ #1479",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - EURIPEDE, A CURATED LIFESTYLE - COLLECTION",
                        "page_views": 3454,
                        "depth_25": 1020,
                        "depth_50": 517,
                        "depth_75": 277,
                        "depth_95": 189,
                        "total_events": 2003
            }
];
        const scrollDepthDataST = [
            {
                        "promotion_number": "1592",
                        "promotion_name": "ê¸°íšì „ #1592",
                        "page_title": "Sergio Tacchini ê³µì‹ ì˜¨ë¼ì¸ëª° - Feature | Tacchini Best Awards",
                        "page_views": 5512,
                        "depth_25": 0,
                        "depth_50": 0,
                        "depth_75": 0,
                        "depth_95": 0,
                        "total_events": 0
            },
            {
                        "promotion_number": "1552",
                        "promotion_name": "ê¸°íšì „ #1552",
                        "page_title": "Sergio Tacchini ê³µì‹ ì˜¨ë¼ì¸ëª° - Feature | WINTER Fleece Moment",
                        "page_views": 4542,
                        "depth_25": 0,
                        "depth_50": 0,
                        "depth_75": 0,
                        "depth_95": 0,
                        "total_events": 0
            },
            {
                        "promotion_number": "1536",
                        "promotion_name": "ê¸°íšì „ #1536",
                        "page_title": "Sergio Tacchini ê³µì‹ ì˜¨ë¼ì¸ëª° - Feature | Urban Fleece collection",
                        "page_views": 2678,
                        "depth_25": 0,
                        "depth_50": 0,
                        "depth_75": 0,
                        "depth_95": 0,
                        "total_events": 0
            },
            {
                        "promotion_number": "1595",
                        "promotion_name": "ê¸°íšì „ #1595",
                        "page_title": "Sergio Tacchini ê³µì‹ ì˜¨ë¼ì¸ëª° - Feature | Super Match 14 Edition",
                        "page_views": 2408,
                        "depth_25": 0,
                        "depth_50": 0,
                        "depth_75": 0,
                        "depth_95": 0,
                        "total_events": 0
            },
            {
                        "promotion_number": "1546",
                        "promotion_name": "ê¸°íšì „ #1546",
                        "page_title": "Sergio Tacchini ê³µì‹ ì˜¨ë¼ì¸ëª° - Feature | Park Ji-hyun with Tacchini Winter Down",
                        "page_views": 878,
                        "depth_25": 0,
                        "depth_50": 0,
                        "depth_75": 0,
                        "depth_95": 0,
                        "total_events": 0
            }
];
        const performanceDataX = [
            {
                        "page_location": "https://www.discovery-expedition.com/display/promotions/collection/1581",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - 26SS ë¼ì´í¬ ì—ì–´ ë°±íŒ© ì‹œë¦¬ì¦ˆ",
                        "page_views": 27157,
                        "purchase_events": 12,
                        "revenue": 1639500.0,
                        "item_view_events": 7051
            },
            {
                        "page_location": "https://www.discovery-expedition.com/display/promotions/collection/1593",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ì›€ì§ì„ê¹Œì§€ ê°€ë²¼ìš´ ë°±íŒ© Like-Air",
                        "page_views": 23061,
                        "purchase_events": 73,
                        "revenue": 14033400.0,
                        "item_view_events": 20619
            },
            {
                        "page_location": "https://www.discovery-expedition.com/display/promotions/collection/1514",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - í”„ë¦¬ë¯¸ì—„ ë¼ì´í”„ìŠ¤íƒ€ì¼ì„ ìœ„í•œ ë ˆìŠ¤í„°G",
                        "page_views": 18290,
                        "purchase_events": 96,
                        "revenue": 28867900.0,
                        "item_view_events": 30108
            },
            {
                        "page_location": "https://www.discovery-expedition.com/display/promotions/collection/1582",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - Ready for School ë‘ê·¼ë‘ê·¼ ì…í•™, ì²« ì±…ê°€ë°©ì„ ë§Œë‚˜ëŠ” ìˆœê°„",
                        "page_views": 7952,
                        "purchase_events": 26,
                        "revenue": 3872900.0,
                        "item_view_events": 11315
            },
            {
                        "page_location": "https://www.discovery-expedition.com/display/promotions/collection/1512",
                        "page_title": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ê²¨ìš¸ ìŠ¤íƒ€ì¼ì„ ì™„ì„±í•˜ëŠ” ìœˆí„° ë¶€ì¸ ",
                        "page_views": 7850,
                        "purchase_events": 64,
                        "revenue": 7686800.0,
                        "item_view_events": 12500
            }
];
        const performanceDataM = [
            {
                        "page_location": "https://www.mlb-korea.com/display/promotions/collection/1520",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - ì¹´ë¦¬ë‚˜ì˜ ê²¨ìš¸ ì‹¤ë£¨ì—£ CURVE THE WINTER",
                        "page_views": 46670,
                        "purchase_events": 520,
                        "revenue": 50555260.0,
                        "item_view_events": 77393
            },
            {
                        "page_location": "https://www.mlb-korea.com/display/promotions/collection/1571",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - LITE ON, MOVE ON! MLB KIDS ì‹ í•™ê¸° ì±…ê°€ë°©",
                        "page_views": 11823,
                        "purchase_events": 68,
                        "revenue": 11452850.0,
                        "item_view_events": 13771
            },
            {
                        "page_location": "https://www.mlb-korea.com/display/promotions/collection/1557",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - KARINA & TWS PICK MLB ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ",
                        "page_views": 11456,
                        "purchase_events": 422,
                        "revenue": 35913300.0,
                        "item_view_events": 42353
            },
            {
                        "page_location": "https://www.mlb-korea.com/display/promotions/collection/1570",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - WINTERâ€™S HEAT WAVE SHOES COLLECTION",
                        "page_views": 10874,
                        "purchase_events": 80,
                        "revenue": 8226650.0,
                        "item_view_events": 16878
            },
            {
                        "page_location": "https://www.mlb-korea.com/display/promotions/collection/1585",
                        "page_title": "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - ì°¨ê°€ìš´ ê²¨ìš¸ì— ë‹¿ëŠ” ë”°ëœ»í•œ í˜œíƒ DEEP WINTER FESTA",
                        "page_views": 2931,
                        "purchase_events": 56,
                        "revenue": 8145020.0,
                        "item_view_events": 7352
            }
];
        const performanceDataV = [
            {
                        "page_location": "https://www.duvetica.co.kr/display/archive/collection/1555",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - DUVETICA with Kim Jiwon - COLLECTION",
                        "page_views": 22771,
                        "purchase_events": 39,
                        "revenue": 32925590.0,
                        "item_view_events": 33480
            },
            {
                        "page_location": "https://www.duvetica.co.kr/display/archive/collection/1587",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - WINTER MOMENT with Ki Eunse - COLLECTION",
                        "page_views": 13098,
                        "purchase_events": 9,
                        "revenue": 7653000.0,
                        "item_view_events": 10931
            },
            {
                        "page_location": "https://www.duvetica.co.kr/display/archive/collection/1586",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - WARMTH IN THE FREEZE - COLLECTION",
                        "page_views": 8140,
                        "purchase_events": 10,
                        "revenue": 8489800.0,
                        "item_view_events": 6721
            },
            {
                        "page_location": "https://www.duvetica.co.kr/display/archive/collection/1545",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - THE SIGNATURE TEXTURES - COLLECTION",
                        "page_views": 2702,
                        "purchase_events": 2,
                        "revenue": 2030900.0,
                        "item_view_events": 2374
            },
            {
                        "page_location": "https://www.duvetica.co.kr/display/archive/collection/1479",
                        "page_title": "ë“€ë² í‹°ì¹´ ê³µì‹ ì˜¨ë¼ì¸ëª° - EURIPEDE, A CURATED LIFESTYLE - COLLECTION",
                        "page_views": 1735,
                        "purchase_events": 2,
                        "revenue": 1464100.0,
                        "item_view_events": 1760
            }
];
        const performanceDataST = [];
        const productsDataX = {
            "https://www.discovery-expedition.com/display/promotions/collection/1512": [
                        {
                                    "item_id": "DXSH6235N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ìŠ¤ë¬´ë”” (BLACK)",
                                    "item_view_events": 696,
                                    "rank": 1
                        },
                        {
                                    "item_id": "DXSH6235N-BGL",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ìŠ¤ë¬´ë”” (BEIGE)",
                                    "item_view_events": 511,
                                    "rank": 2
                        },
                        {
                                    "item_id": "DXSH6235N-WHS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ìŠ¤ë¬´ë”” (WHITE)",
                                    "item_view_events": 404,
                                    "rank": 3
                        },
                        {
                                    "item_id": "DXSH6122N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë ˆìŠ¤í„° QT ë¶€ì¸  (BLACK)",
                                    "item_view_events": 385,
                                    "rank": 4
                        },
                        {
                                    "item_id": "DXSH6225N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ì˜¤ë¸Œ (BLACK)",
                                    "item_view_events": 361,
                                    "rank": 5
                        }
            ],
            "https://www.discovery-expedition.com/display/promotions/collection/1514": [
                        {
                                    "item_id": "DMDJ61056-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë‚¨ì„± ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ìˆíŒ¨ë”© (BLACK)",
                                    "item_view_events": 1297,
                                    "rank": 1
                        },
                        {
                                    "item_id": "DMDJ67056-DGS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë‚¨ì„± ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ë¡±íŒ¨ë”© (DARK GRAY)",
                                    "item_view_events": 992,
                                    "rank": 2
                        },
                        {
                                    "item_id": "DMDJ61056-GRD",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë‚¨ì„± ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ìˆíŒ¨ë”© (DARK GRAY)",
                                    "item_view_events": 799,
                                    "rank": 3
                        },
                        {
                                    "item_id": "DMDJ61056-IND",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë‚¨ì„± ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ìˆíŒ¨ë”© (BLUE)",
                                    "item_view_events": 581,
                                    "rank": 4
                        },
                        {
                                    "item_id": "DMDJ67056-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë‚¨ì„± ë ˆìŠ¤í„°G êµ¬ìŠ¤ë‹¤ìš´ ë¡±íŒ¨ë”© (BLACK)",
                                    "item_view_events": 566,
                                    "rank": 5
                        }
            ],
            "https://www.discovery-expedition.com/display/promotions/collection/1581": [
                        {
                                    "item_id": "DXBK0116N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ë…¸ë°” ë°±íŒ© 31 (BLACK)",
                                    "item_view_events": 382,
                                    "rank": 1
                        },
                        {
                                    "item_id": "DXBK0116N-GRL",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ë…¸ë°” ë°±íŒ© 31 (LIGHT GRAY)",
                                    "item_view_events": 258,
                                    "rank": 2
                        },
                        {
                                    "item_id": "DXBK0176N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ë¼ì´íŠ¸ ë°±íŒ© 23 (BLACK)",
                                    "item_view_events": 177,
                                    "rank": 3
                        },
                        {
                                    "item_id": "DXBK0036N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ í”Œë¡œ ë°±íŒ© 31 (BLACK)",
                                    "item_view_events": 177,
                                    "rank": 4
                        },
                        {
                                    "item_id": "DXBK0126N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ì›ë” ë°±íŒ© 31 (BLACK)",
                                    "item_view_events": 173,
                                    "rank": 5
                        }
            ],
            "https://www.discovery-expedition.com/display/promotions/collection/1582": [
                        {
                                    "item_id": "DKBK2026N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ í”ŒëŸ­ìŠ¤ ë°±íŒ© 16 (BLACK)",
                                    "item_view_events": 602,
                                    "rank": 1
                        },
                        {
                                    "item_id": "DKBK2016N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ì—ì„¼ì…œ ì„¸íŠ¸ 14 (BLACK)",
                                    "item_view_events": 498,
                                    "rank": 2
                        },
                        {
                                    "item_id": "DKBK2016N-BES",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ì—ì„¼ì…œ ì„¸íŠ¸ 14 (BEIGE)",
                                    "item_view_events": 452,
                                    "rank": 3
                        },
                        {
                                    "item_id": "DKBK2016N-PPL",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ì—ì„¼ì…œ ì„¸íŠ¸ 14 (VIOLET)",
                                    "item_view_events": 319,
                                    "rank": 4
                        },
                        {
                                    "item_id": "DKBK2036N-PPL",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ë¡œì—” ë°±íŒ© ì„¸íŠ¸ 15 (VIOLET)",
                                    "item_view_events": 311,
                                    "rank": 5
                        }
            ],
            "https://www.discovery-expedition.com/display/promotions/collection/1593": [
                        {
                                    "item_id": "DXBK0116N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ë…¸ë°” ë°±íŒ© 31 (BLACK)",
                                    "item_view_events": 799,
                                    "rank": 1
                        },
                        {
                                    "item_id": "DXBK0116N-BES",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ë…¸ë°” ë°±íŒ© 31 (BEIGE)",
                                    "item_view_events": 564,
                                    "rank": 2
                        },
                        {
                                    "item_id": "DXBK0126N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ ì›ë” ë°±íŒ© 31 (BLACK)",
                                    "item_view_events": 548,
                                    "rank": 3
                        },
                        {
                                    "item_id": "DWDJ9A056-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ì—¬ì„± ì¼ˆë¦¬ êµ¬ìŠ¤ë‹¤ìš´ ë¡±íŒ¨ë”© (BLACK)",
                                    "item_view_events": 324,
                                    "rank": 4
                        },
                        {
                                    "item_id": "DXBK0036N-BKS",
                                    "item_name": "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ | ë¼ì´í¬ ì—ì–´ í”Œë¡œ ë°±íŒ© 31 (BLACK)",
                                    "item_view_events": 323,
                                    "rank": 5
                        }
            ]
};
        const productsDataM = {
            "https://www.mlb-korea.com/display/promotions/collection/1520": [
                        {
                                    "item_id": "3ABNB1156-50BKS",
                                    "item_name": "MLB í”ŒëŸ¬ì‹œ ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 2201,
                                    "rank": 1
                        },
                        {
                                    "item_id": "3ABNB1156-50CRS",
                                    "item_name": "MLB í”ŒëŸ¬ì‹œ ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ ë‰´ìš•ì–‘í‚¤ìŠ¤ (CREAM)",
                                    "item_view_events": 1287,
                                    "rank": 2
                        },
                        {
                                    "item_id": "3ADJB2656-50BKS",
                                    "item_name": "MLB ì»¤ë¸ŒíŒ¨ë”© ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 1131,
                                    "rank": 3
                        },
                        {
                                    "item_id": "3ABNB1156-50NYS",
                                    "item_name": "MLB í”ŒëŸ¬ì‹œ ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ ë‰´ìš•ì–‘í‚¤ìŠ¤ (NAVY)",
                                    "item_view_events": 991,
                                    "rank": 4
                        },
                        {
                                    "item_id": "3ACP6601N-50BKS",
                                    "item_name": "MLB ì—ì´ìŠ¤ ì–¸ìŠ¤íŠ¸ëŸ­ì³ ë³¼ìº¡ ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 817,
                                    "rank": 5
                        }
            ],
            "https://www.mlb-korea.com/display/promotions/collection/1557": [
                        {
                                    "item_id": "3ABNB1156-50BKS",
                                    "item_name": "MLB í”ŒëŸ¬ì‹œ ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 2798,
                                    "rank": 1
                        },
                        {
                                    "item_id": "3ABNB1156-50CRS",
                                    "item_name": "MLB í”ŒëŸ¬ì‹œ ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ ë‰´ìš•ì–‘í‚¤ìŠ¤ (CREAM)",
                                    "item_view_events": 1995,
                                    "rank": 2
                        },
                        {
                                    "item_id": "3ABNB1156-50NYS",
                                    "item_name": "MLB í”ŒëŸ¬ì‹œ ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ ë‰´ìš•ì–‘í‚¤ìŠ¤ (NAVY)",
                                    "item_view_events": 1418,
                                    "rank": 3
                        },
                        {
                                    "item_id": "3ABNB1156-43PKL",
                                    "item_name": "MLB í”ŒëŸ¬ì‹œ ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ ë³´ìŠ¤í„´ ë ˆë“œì‚­ìŠ¤ (PINK)",
                                    "item_view_events": 1268,
                                    "rank": 4
                        },
                        {
                                    "item_id": "3ABNB1156-07SBD",
                                    "item_name": "MLB í”ŒëŸ¬ì‹œ ë¯¸ì•¼ì˜¹ ë¹„ë‹ˆ LAë‹¤ì €ìŠ¤ (SKY BLUE)",
                                    "item_view_events": 1055,
                                    "rank": 5
                        }
            ],
            "https://www.mlb-korea.com/display/promotions/collection/1570": [
                        {
                                    "item_id": "3AWBCPM56-50BGL",
                                    "item_name": "MLB ì»¤ë¸Œ íŒ¨ë”© ë¶€ì¸  ë¯¸ë“œ ë ˆì´ìŠ¤ ë‰´ìš•ì–‘í‚¤ìŠ¤ (LIGHT BEIGE)",
                                    "item_view_events": 693,
                                    "rank": 1
                        },
                        {
                                    "item_id": "3AWBCPM56-50BKS",
                                    "item_name": "MLB ì»¤ë¸Œ íŒ¨ë”© ë¶€ì¸  ë¯¸ë“œ ë ˆì´ìŠ¤ ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 615,
                                    "rank": 2
                        },
                        {
                                    "item_id": "3AWBCP156-50BKS",
                                    "item_name": "MLB ì»¤ë¸Œ íŒ¨ë”© ìŠ¬ë¦½ì˜¨ ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 410,
                                    "rank": 3
                        },
                        {
                                    "item_id": "3AWBCPL56-43BRL",
                                    "item_name": "MLB í”ŒëŸ¬ì‰¬ íŒ¨ë”© ë®¬ ë ˆì´ìŠ¤ ë³´ìŠ¤í„´ ë ˆë“œì‚­ìŠ¤ (BROWN)",
                                    "item_view_events": 233,
                                    "rank": 4
                        },
                        {
                                    "item_id": "3AWBCSW56-50BRS",
                                    "item_name": "MLB ì›Œë¨¸ ìŠ¤ì›¨ì´ë“œ ë¶€ì¸  ë‰´ìš•ì–‘í‚¤ìŠ¤ (BROWN)",
                                    "item_view_events": 230,
                                    "rank": 5
                        }
            ],
            "https://www.mlb-korea.com/display/promotions/collection/1571": [
                        {
                                    "item_id": "7ABKB016N-50LDS",
                                    "item_name": "MLB íƒœê·¸ ë¼ì´íŠ¸ ì±…ê°€ë°© ì„¸íŠ¸ ë‰´ìš•ì–‘í‚¤ìŠ¤ (LAVENDER)",
                                    "item_view_events": 1350,
                                    "rank": 1
                        },
                        {
                                    "item_id": "7ABKB016N-50BKS",
                                    "item_name": "MLB íƒœê·¸ ë¼ì´íŠ¸ ì±…ê°€ë°© ì„¸íŠ¸ ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 714,
                                    "rank": 2
                        },
                        {
                                    "item_id": "7ABKB056N-50BKS",
                                    "item_name": "MLB íƒœê·¸ í”Œë¼ì´ ì±…ê°€ë°© ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 648,
                                    "rank": 3
                        },
                        {
                                    "item_id": "7ABKB016N-07NYS",
                                    "item_name": "MLB íƒœê·¸ ë¼ì´íŠ¸ ì±…ê°€ë°© ì„¸íŠ¸ LAë‹¤ì €ìŠ¤ (NAVY)",
                                    "item_view_events": 623,
                                    "rank": 4
                        },
                        {
                                    "item_id": "7FBKM026N-50PKS",
                                    "item_name": "MLB ì˜¤ë¡œë¼ ì±…ê°€ë°© ì„¸íŠ¸ ë‰´ìš•ì–‘í‚¤ìŠ¤ (PINK)",
                                    "item_view_events": 501,
                                    "rank": 5
                        }
            ],
            "https://www.mlb-korea.com/display/promotions/collection/1585": [
                        {
                                    "item_id": "7ABKB016N-50BKS",
                                    "item_name": "MLB íƒœê·¸ ë¼ì´íŠ¸ ì±…ê°€ë°© ì„¸íŠ¸ ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 107,
                                    "rank": 1
                        },
                        {
                                    "item_id": "7ADJB1556-50BKS",
                                    "item_name": "MLB ì—ì–´ ë°ì¼ë¦¬ ê¸€ë¡œì‹œ ë¡± êµ¬ìŠ¤ë‹¤ìš´ ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 103,
                                    "rank": 2
                        },
                        {
                                    "item_id": "7ADJEB156-50CGD",
                                    "item_name": "MLB ìŠ¤í¬í‹°ë¸Œ ë• ìˆë‹¤ìš´ ë‰´ìš•ì–‘í‚¤ìŠ¤ (DARK GRAY)",
                                    "item_view_events": 98,
                                    "rank": 3
                        },
                        {
                                    "item_id": "7ABKB056N-50BKS",
                                    "item_name": "MLB íƒœê·¸ í”Œë¼ì´ ì±…ê°€ë°© ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 93,
                                    "rank": 4
                        },
                        {
                                    "item_id": "7ADJB0556-50BKS",
                                    "item_name": "MLB ì—ì–´ ë°ì¼ë¦¬ ê¸€ë¡œì‹œ ìˆ ë•ë‹¤ìš´ ë‰´ìš•ì–‘í‚¤ìŠ¤ (BLACK)",
                                    "item_view_events": 73,
                                    "rank": 5
                        }
            ]
};
        const productsDataV = {
            "https://www.duvetica.co.kr/display/archive/collection/1479": [
                        {
                                    "item_id": "VDDH36361-BKL",
                                    "item_name": "ë“€ë² í‹°ì¹´ [ì¬ì…ê³ ] ì—ìš°ë¦¬í”¼ë° ë²¨ë²³ (BLACK)",
                                    "item_view_events": 218,
                                    "rank": 1
                        },
                        {
                                    "item_id": "VDDH31255-GRD",
                                    "item_name": "ë“€ë² í‹°ì¹´ ì—ìš°ë¦¬í”¼ë° (DARK GRAY)",
                                    "item_view_events": 66,
                                    "rank": 2
                        },
                        {
                                    "item_id": "VDDH36355-BKL",
                                    "item_name": "ë“€ë² í‹°ì¹´ [40ì‚¬ì´ì¦ˆ íŒë§¤] ì—ìš°ë¦¬í”¼ë° ë²¨ë²³ (BLACK)",
                                    "item_view_events": 47,
                                    "rank": 3
                        },
                        {
                                    "item_id": "VDDH31255-CRS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ì—ìš°ë¦¬í”¼ë° (CREAM)",
                                    "item_view_events": 34,
                                    "rank": 4
                        },
                        {
                                    "item_id": "VDDJ36455-BRD",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë°”ë¥¼ë ˆíƒ€ (BROWN)",
                                    "item_view_events": 29,
                                    "rank": 5
                        }
            ],
            "https://www.duvetica.co.kr/display/archive/collection/1545": [
                        {
                                    "item_id": "VDDJ15256-BKL",
                                    "item_name": "ë“€ë² í‹°ì¹´ í† ë¦¬ì‚¬ ë²¨ë²³ (BLACK)",
                                    "item_view_events": 105,
                                    "rank": 1
                        },
                        {
                                    "item_id": "VDDJ15456-BLL",
                                    "item_name": "ë“€ë² í‹°ì¹´ í† ë¦¬ì‚¬ ìŠ¤ì›¨ì´ë“œ (SKY BLUE)",
                                    "item_view_events": 78,
                                    "rank": 2
                        },
                        {
                                    "item_id": "VDDH36361-BKL",
                                    "item_name": "ë“€ë² í‹°ì¹´ [ì¬ì…ê³ ] ì—ìš°ë¦¬í”¼ë° ë²¨ë²³ (BLACK)",
                                    "item_view_events": 63,
                                    "rank": 3
                        },
                        {
                                    "item_id": "VDDJ31656-BKL",
                                    "item_name": "ë“€ë² í‹°ì¹´ ì•Œë¡œë¡œ ë²¨ë²³ (BLACK)",
                                    "item_view_events": 56,
                                    "rank": 4
                        },
                        {
                                    "item_id": "VDDJ15056-BRD",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë””ì•„ë°ë§ˆ ìŠˆê°€ (BROWN)",
                                    "item_view_events": 53,
                                    "rank": 5
                        }
            ],
            "https://www.duvetica.co.kr/display/archive/collection/1555": [
                        {
                                    "item_id": "VDDJ16556-OLD",
                                    "item_name": "ë“€ë² í‹°ì¹´ ì•Œë°”ë¥´ë‹¤ N (KHAKI)",
                                    "item_view_events": 1156,
                                    "rank": 1
                        },
                        {
                                    "item_id": "VDDJ33456-BKS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ì•Œë¦¬ìŠ¤ì¹´ (BLACK)",
                                    "item_view_events": 765,
                                    "rank": 2
                        },
                        {
                                    "item_id": "VDDJ36056-BKS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë§ˆë¼í…Œì•„ (BLACK)",
                                    "item_view_events": 707,
                                    "rank": 3
                        },
                        {
                                    "item_id": "VDDJ31656-BKL",
                                    "item_name": "ë“€ë² í‹°ì¹´ ì•Œë¡œë¡œ ë²¨ë²³ (BLACK)",
                                    "item_view_events": 681,
                                    "rank": 4
                        },
                        {
                                    "item_id": "VDDJ35856-CRS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë§ˆë¼í…Œì•„ ë¯¸ë“œ (CREAM)",
                                    "item_view_events": 643,
                                    "rank": 5
                        }
            ],
            "https://www.duvetica.co.kr/display/archive/collection/1586": [
                        {
                                    "item_id": "VDDJ33456-BKS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ì•Œë¦¬ìŠ¤ì¹´ (BLACK)",
                                    "item_view_events": 255,
                                    "rank": 1
                        },
                        {
                                    "item_id": "VDDJ31156-BKS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë¼ë°”ë¡œë„¤ (BLACK)",
                                    "item_view_events": 200,
                                    "rank": 2
                        },
                        {
                                    "item_id": "VDDJ33456-NYS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ì•Œë¦¬ìŠ¤ì¹´ (NAVY)",
                                    "item_view_events": 195,
                                    "rank": 3
                        },
                        {
                                    "item_id": "VDDJ16156-BKL",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë²¨ë¼íŠ¸ë¦­ìŠ¤ ëŸ­ìŠ¤ (BLACK)",
                                    "item_view_events": 179,
                                    "rank": 4
                        },
                        {
                                    "item_id": "VDDJ15056-BRD",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë””ì•„ë°ë§ˆ ìŠˆê°€ (BROWN)",
                                    "item_view_events": 142,
                                    "rank": 5
                        }
            ],
            "https://www.duvetica.co.kr/display/archive/collection/1587": [
                        {
                                    "item_id": "VDDJ31156-BKS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë¼ë°”ë¡œë„¤ (BLACK)",
                                    "item_view_events": 438,
                                    "rank": 1
                        },
                        {
                                    "item_id": "VDDJ31156-IVD",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë¼ë°”ë¡œë„¤ (IVORY)",
                                    "item_view_events": 427,
                                    "rank": 2
                        },
                        {
                                    "item_id": "VDDJ33456-BKS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ì•Œë¦¬ìŠ¤ì¹´ (BLACK)",
                                    "item_view_events": 367,
                                    "rank": 3
                        },
                        {
                                    "item_id": "VDDJ16156-BKL",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë²¨ë¼íŠ¸ë¦­ìŠ¤ ëŸ­ìŠ¤ (BLACK)",
                                    "item_view_events": 320,
                                    "rank": 4
                        },
                        {
                                    "item_id": "VDDJ35456-BKS",
                                    "item_name": "ë“€ë² í‹°ì¹´ ë¦¬í”¼ë‚˜ (BLACK)",
                                    "item_view_events": 281,
                                    "rank": 5
                        }
            ]
};
        
        let chartX = null;
        let chartM = null;
        let chartV = null;
        let chartST = null;

        function getShortTitle(pageTitle, brand) {
            if (!pageTitle) return '';
            // X ë¸Œëœë“œ: "ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - " ì œê±°
            if (brand === 'X') {
                const prefix = 'ë””ìŠ¤ì»¤ë²„ë¦¬ ìµìŠ¤í˜ë””ì…˜ - ';
                if (pageTitle.startsWith(prefix)) {
                    return pageTitle.substring(prefix.length);
                }
            }
            // M ë¸Œëœë“œ: "ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - " ì œê±°
            else if (brand === 'M') {
                const prefix = 'ì— ì—˜ë¹„ ì½”ë¦¬ì•„ - ';
                if (pageTitle.startsWith(prefix)) {
                    return pageTitle.substring(prefix.length);
                }
            }
            // V ë¸Œëœë“œ: "ë“€ë² í‹°ì¹´ - " ì œê±°
            else if (brand === 'V') {
                const prefix = 'ë“€ë² í‹°ì¹´ - ';
                if (pageTitle.startsWith(prefix)) {
                    return pageTitle.substring(prefix.length);
                }
            }
            // ST ë¸Œëœë“œ: ì ‘ë‘ì‚¬ ì œê±° (í•„ìš”ì‹œ ìˆ˜ì •)
            else if (brand === 'ST') {
                // ST ë¸Œëœë“œì˜ ì ‘ë‘ì‚¬ëŠ” ë°ì´í„° í™•ì¸ í›„ ì¶”ê°€
                return pageTitle;
            }
            return pageTitle;
        }

        function switchTab(brand) {
            // íƒ­ ë²„íŠ¼ í™œì„±í™”
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // íƒ­ ì½˜í…ì¸  í‘œì‹œ
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`tab-${brand}`).classList.add('active');
        }

        function renderInsights(scrollDepthData, brand, performanceData, productsData) {
            const insightsContent = document.getElementById(`insightsContent${brand}`);
            
            // í˜ì´ì§€ ì œëª© ì¶”ì¶œ í—¬í¼ í•¨ìˆ˜
            const getShortTitleHelper = (pageTitle) => getShortTitle(pageTitle || '', brand);
            
            // ê¸°íšì „ ë²ˆí˜¸ ì¶”ì¶œ í•¨ìˆ˜
            const getPromotionNumber = (pageLocation) => {
                if (!pageLocation) return '';
                const match = pageLocation.match(/\/collection\/(\d+)/);
                return match ? match[1] : '';
            };
            
            // ê¸°íšì „ URL ìƒì„± í•¨ìˆ˜
            const getPromotionUrl = (promotionNumber) => {
                if (!promotionNumber) return '';
                if (brand === 'X') {
                    return `https://www.discovery-expedition.com/display/promotions/collection/${promotionNumber}`;
                } else if (brand === 'M') {
                    return `https://www.mlb-korea.com/display/promotions/collection/${promotionNumber}`;
                } else if (brand === 'V') {
                    return `https://www.duvetica.co.kr/display/archive/collection/${promotionNumber}`;
                }
                return '';
            };
            
            // ê¸°íšì „ ì´ë¦„ì— ë§í¬ ì¶”ê°€ í•¨ìˆ˜
            const getPromotionLink = (promotionName, promotionNumber) => {
                if (!promotionName || !promotionNumber) return promotionName || '';
                const url = getPromotionUrl(promotionNumber);
                if (!url) return promotionName;
                return `<a href="${url}" target="_blank" style="color:#667eea; text-decoration:underline;">${promotionName}</a>`;
            };
            
            let scrollDepthInsights = '';
            let performanceInsights = '';
            let productsInsights = '';
            
            // 1. ìŠ¤í¬ë¡¤ ëìŠ¤ ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸
            if (scrollDepthData && scrollDepthData.length > 0) {
                const bestOverall = scrollDepthData.reduce((best, item) => {
                    const rate95 = item.total_events > 0 ? (item.depth_95 / item.total_events * 100) : 0;
                    const bestRate95 = best.total_events > 0 ? (best.depth_95 / best.total_events * 100) : 0;
                    return rate95 > bestRate95 ? item : best;
                }, scrollDepthData[0]);

                const bestParticipation = scrollDepthData.reduce((best, item) => {
                    const participation = item.page_views > 0 ? (item.total_events / item.page_views * 100) : 0;
                    const bestParticipationRate = best.page_views > 0 ? (best.total_events / best.page_views * 100) : 0;
                    return participation > bestParticipationRate ? item : best;
                }, scrollDepthData[0]);

                const worstDropoff = scrollDepthData.map(item => {
                    const rate25 = item.total_events > 0 ? (item.depth_25 / item.total_events * 100) : 0;
                    const rate50 = item.total_events > 0 ? (item.depth_50 / item.total_events * 100) : 0;
                    const dropoff = rate25 - rate50;
                    return {...item, dropoff};
                }).reduce((worst, item) => item.dropoff > worst.dropoff ? item : worst);

                const worstFinal = scrollDepthData.reduce((worst, item) => {
                    const rate95 = item.total_events > 0 ? (item.depth_95 / item.total_events * 100) : 0;
                    const worstRate95 = worst.total_events > 0 ? (worst.depth_95 / worst.total_events * 100) : 0;
                    return rate95 < worstRate95 ? item : worst;
                }, scrollDepthData[0]);

                const bestRate95 = bestOverall.total_events > 0 ? (bestOverall.depth_95 / bestOverall.total_events * 100).toFixed(1) : 0;
                const bestParticipationRate = bestParticipation.page_views > 0 ? (bestParticipation.total_events / bestParticipation.page_views * 100).toFixed(1) : 0;
                const worstDropoffRate = worstDropoff.dropoff.toFixed(1);
                const worstFinalRate = worstFinal.total_events > 0 ? (worstFinal.depth_95 / worstFinal.total_events * 100).toFixed(1) : 0;

                const bestOverallTitle = getShortTitleHelper(bestOverall.page_title);
                const bestParticipationTitle = getShortTitleHelper(bestParticipation.page_title);
                const worstDropoffTitle = getShortTitleHelper(worstDropoff.page_title);
                const worstFinalTitle = getShortTitleHelper(worstFinal.page_title);
                
                const bestOverallLink = getPromotionLink(bestOverall.promotion_name, bestOverall.promotion_number);
                const bestParticipationLink = getPromotionLink(bestParticipation.promotion_name, bestParticipation.promotion_number);
                const worstDropoffLink = getPromotionLink(worstDropoff.promotion_name, worstDropoff.promotion_number);
                const worstFinalLink = getPromotionLink(worstFinal.promotion_name, worstFinal.promotion_number);

                scrollDepthInsights = `
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #1a1a1a; font-size: 1.3em; margin-bottom: 20px; font-weight: 700; padding-bottom: 10px; border-bottom: 2px solid #e5e7eb;">
                            ğŸ“Š ìŠ¤í¬ë¡¤ ëìŠ¤ ë¶„ì„
                        </h3>
                        <div class="insight-grid">
                            <div class="insight-card excellent">
                                <h3>â­ ìš°ìˆ˜ ì‚¬ë¡€ - ìµœê³  ë„ë‹¬ë¥ </h3>
                                <ul>
                                    <li><strong>${bestOverallLink}</strong></li>
                                    <li>${bestOverallTitle ? '<span style="color:#667eea;">' + bestOverallTitle + '</span>' : ''}</li>
                                    <li>ìµœì¢… ë„ë‹¬ë¥ (95%): <strong>${bestRate95}%</strong></li>
                                    <li>ì•ˆì •ì ì¸ ìŠ¤í¬ë¡¤ íŒ¨í„´ìœ¼ë¡œ ë²¤ì¹˜ë§ˆí¬ë¡œ í™œìš© ê¶Œì¥</li>
                                    <li>ì´ˆ-ì¤‘ë°˜ êµ¬ê°„ ì´íƒˆë¥ ì´ ë‚®ì•„ ì°¸ì—¬ ìœ ì§€ íš¨ê³¼ì </li>
                                </ul>
                            </div>

                            <div class="insight-card excellent">
                                <h3>ğŸš€ ìš°ìˆ˜ ì‚¬ë¡€ - ë†’ì€ ì°¸ì—¬ë„</h3>
                                <ul>
                                    <li><strong>${bestParticipationLink}</strong></li>
                                    <li>${bestParticipationTitle ? '<span style="color:#667eea;">' + bestParticipationTitle + '</span>' : ''}</li>
                                    <li>ìŠ¤í¬ë¡¤ ì°¸ì—¬ë„: <strong>${bestParticipationRate}%</strong></li>
                                    <li>í˜ì´ì§€ë·° ëŒ€ë¹„ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë¹„ìœ¨ì´ ê°€ì¥ ë†’ìŒ</li>
                                    <li>ì´ˆê¸° í™”ë©´ êµ¬ì„±ì´ ì‚¬ìš©ìì˜ ìŠ¤í¬ë¡¤ ì˜ìš•ì„ íš¨ê³¼ì ìœ¼ë¡œ ìê·¹</li>
                                </ul>
                            </div>

                            <div class="insight-card warning">
                                <h3>âš ï¸ ê°œì„  í•„ìš” - ê¸‰ê²©í•œ ì¤‘ë°˜ ì´íƒˆ</h3>
                                <ul>
                                    <li><strong>${worstDropoffLink}</strong></li>
                                    <li>${worstDropoffTitle ? '<span style="color:#667eea;">' + worstDropoffTitle + '</span>' : ''}</li>
                                    <li>25-50% êµ¬ê°„ ì´íƒˆë¥ : <strong>${worstDropoffRate}%p</strong></li>
                                    <li>ì´ˆë°˜ ì°¸ì—¬ëŠ” ë†’ìœ¼ë‚˜ ì¤‘ë°˜ êµ¬ê°„ì—ì„œ ê¸‰ê²©í•œ ì´íƒˆ ë°œìƒ</li>
                                    <li>25-50% êµ¬ê°„ ì½˜í…ì¸  ì¬êµ¬ì„± ë° CTA ë°°ì¹˜ ìµœì í™” í•„ìš”</li>
                                </ul>
                            </div>

                            <div class="insight-card alert">
                                <h3>ğŸ”´ ê°œì„  í•„ìš” - ë‚®ì€ ìµœì¢… ë„ë‹¬ë¥ </h3>
                                <ul>
                                    <li><strong>${worstFinalLink}</strong></li>
                                    <li>${worstFinalTitle ? '<span style="color:#667eea;">' + worstFinalTitle + '</span>' : ''}</li>
                                    <li>ìµœì¢… ë„ë‹¬ë¥ (95%): <strong>${worstFinalRate}%</strong></li>
                                    <li>í›„ë°˜ë¶€ ì½˜í…ì¸  ê°œì„  ë° ìµœì¢… êµ¬ê°„ ê°•í™” í•„ìš”</li>
                                    <li>75-95% êµ¬ê°„ì— ê°•ë ¥í•œ CTA ë°°ì¹˜ ê¶Œì¥</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
            }

            // 2. ê¸°íšì „ í˜ì´ì§€ë³„ ì„±ê³¼ ê¸°ì¤€ ì¸ì‚¬ì´íŠ¸
            if (performanceData && performanceData.length > 0) {
                // ìµœê³  ë§¤ì¶œ
                const bestRevenue = performanceData.reduce((best, item) => {
                    return (item.revenue || 0) > (best.revenue || 0) ? item : best;
                }, performanceData[0]);

                // ìµœê³  êµ¬ë§¤ ì „í™˜ìœ¨
                const bestConversion = performanceData.map(item => {
                    const conversionRate = (item.item_view_events || 0) > 0 
                        ? ((item.purchase_events || 0) / (item.item_view_events || 0) * 100) 
                        : 0;
                    return {...item, conversionRate};
                }).reduce((best, item) => item.conversionRate > best.conversionRate ? item : best);

                // ìµœì € êµ¬ë§¤ ì „í™˜ìœ¨ (ê°œì„  í•„ìš”)
                const worstConversion = performanceData.map(item => {
                    const conversionRate = (item.item_view_events || 0) > 0 
                        ? ((item.purchase_events || 0) / (item.item_view_events || 0) * 100) 
                        : 0;
                    return {...item, conversionRate};
                }).reduce((worst, item) => item.conversionRate < worst.conversionRate ? item : worst);

                // ìµœì € ë§¤ì¶œ (ê°œì„  í•„ìš”)
                const worstRevenue = performanceData.reduce((worst, item) => {
                    return (item.revenue || 0) < (worst.revenue || 0) ? item : worst;
                }, performanceData[0]);

                const bestRevenueTitle = getShortTitleHelper(bestRevenue.page_title);
                const bestRevenuePromo = getPromotionNumber(bestRevenue.page_location || '');
                const bestRevenuePromoName = bestRevenuePromo ? `ê¸°íšì „ #${bestRevenuePromo}` : '';
                const bestRevenueLink = bestRevenue.page_location ? `<a href="${bestRevenue.page_location}" target="_blank" style="color:#667eea; text-decoration:underline;">${bestRevenuePromoName}</a>` : bestRevenuePromoName;

                const bestConversionTitle = getShortTitleHelper(bestConversion.page_title);
                const bestConversionPromo = getPromotionNumber(bestConversion.page_location || '');
                const bestConversionPromoName = bestConversionPromo ? `ê¸°íšì „ #${bestConversionPromo}` : '';
                const bestConversionLink = bestConversion.page_location ? `<a href="${bestConversion.page_location}" target="_blank" style="color:#667eea; text-decoration:underline;">${bestConversionPromoName}</a>` : bestConversionPromoName;
                const bestConversionRate = bestConversion.conversionRate ? bestConversion.conversionRate.toFixed(2) : '0.00';

                const worstConversionTitle = getShortTitleHelper(worstConversion.page_title);
                const worstConversionPromo = getPromotionNumber(worstConversion.page_location || '');
                const worstConversionPromoName = worstConversionPromo ? `ê¸°íšì „ #${worstConversionPromo}` : '';
                const worstConversionLink = worstConversion.page_location ? `<a href="${worstConversion.page_location}" target="_blank" style="color:#667eea; text-decoration:underline;">${worstConversionPromoName}</a>` : worstConversionPromoName;
                const worstConversionRate = worstConversion.conversionRate ? worstConversion.conversionRate.toFixed(2) : '0.00';

                const worstRevenueTitle = getShortTitleHelper(worstRevenue.page_title);
                const worstRevenuePromo = getPromotionNumber(worstRevenue.page_location || '');
                const worstRevenuePromoName = worstRevenuePromo ? `ê¸°íšì „ #${worstRevenuePromo}` : '';
                const worstRevenueLink = worstRevenue.page_location ? `<a href="${worstRevenue.page_location}" target="_blank" style="color:#667eea; text-decoration:underline;">${worstRevenuePromoName}</a>` : worstRevenuePromoName;

                performanceInsights = `
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #1a1a1a; font-size: 1.3em; margin-bottom: 20px; font-weight: 700; padding-bottom: 10px; border-bottom: 2px solid #e5e7eb;">
                            ğŸ“ˆ ê¸°íšì „ í˜ì´ì§€ë³„ ì„±ê³¼ ë¶„ì„
                        </h3>
                        <div class="insight-grid">
                            <div class="insight-card excellent">
                                <h3>ğŸ’° ìš°ìˆ˜ ì‚¬ë¡€ - ìµœê³  ë§¤ì¶œ</h3>
                                <ul>
                                    <li><strong>${bestRevenueLink}</strong></li>
                                    <li>${bestRevenueTitle ? '<span style="color:#667eea;">' + bestRevenueTitle + '</span>' : ''}</li>
                                    <li>ë§¤ì¶œ: <strong>â‚©${Math.round(bestRevenue.revenue || 0).toLocaleString()}</strong></li>
                                    <li>êµ¬ë§¤ ì´ë²¤íŠ¸: <strong>${(bestRevenue.purchase_events || 0).toLocaleString()}ê±´</strong></li>
                                    <li>ê°€ì¥ ë†’ì€ ë§¤ì¶œì„ ê¸°ë¡í•œ ê¸°íšì „ìœ¼ë¡œ ì „ëµ ë¶„ì„ í•„ìš”</li>
                                </ul>
                            </div>

                            <div class="insight-card excellent">
                                <h3>ğŸ“ˆ ìš°ìˆ˜ ì‚¬ë¡€ - ìµœê³  êµ¬ë§¤ ì „í™˜ìœ¨</h3>
                                <ul>
                                    <li><strong>${bestConversionLink}</strong></li>
                                    <li>${bestConversionTitle ? '<span style="color:#667eea;">' + bestConversionTitle + '</span>' : ''}</li>
                                    <li>êµ¬ë§¤ ì „í™˜ìœ¨: <strong>${bestConversionRate}%</strong></li>
                                    <li>ìƒí’ˆ ì¡°íšŒ ëŒ€ë¹„ êµ¬ë§¤ ì „í™˜ì´ ê°€ì¥ íš¨ìœ¨ì </li>
                                    <li>CTA ë° ìƒí’ˆ êµ¬ì„± ì „ëµì„ ë²¤ì¹˜ë§ˆí¬ë¡œ í™œìš©</li>
                                </ul>
                            </div>

                            <div class="insight-card warning">
                                <h3>âš ï¸ ê°œì„  í•„ìš” - ë‚®ì€ êµ¬ë§¤ ì „í™˜ìœ¨</h3>
                                <ul>
                                    <li><strong>${worstConversionLink}</strong></li>
                                    <li>${worstConversionTitle ? '<span style="color:#667eea;">' + worstConversionTitle + '</span>' : ''}</li>
                                    <li>êµ¬ë§¤ ì „í™˜ìœ¨: <strong>${worstConversionRate}%</strong></li>
                                    <li>ìƒí’ˆ ì¡°íšŒ ëŒ€ë¹„ êµ¬ë§¤ ì „í™˜ì´ ë‚®ìŒ</li>
                                    <li>CTA ìœ„ì¹˜, ê°€ê²© ì „ëµ, ìƒí’ˆ ì„¤ëª… ë“± ì¬ê²€í†  í•„ìš”</li>
                                </ul>
                            </div>

                            <div class="insight-card alert">
                                <h3>ğŸ”´ ê°œì„  í•„ìš” - ë‚®ì€ ë§¤ì¶œ</h3>
                                <ul>
                                    <li><strong>${worstRevenueLink}</strong></li>
                                    <li>${worstRevenueTitle ? '<span style="color:#667eea;">' + worstRevenueTitle + '</span>' : ''}</li>
                                    <li>ë§¤ì¶œ: <strong>â‚©${Math.round(worstRevenue.revenue || 0).toLocaleString()}</strong></li>
                                    <li>êµ¬ë§¤ ì´ë²¤íŠ¸: <strong>${(worstRevenue.purchase_events || 0).toLocaleString()}ê±´</strong></li>
                                    <li>ë§¤ì¶œ ê°œì„ ì„ ìœ„í•œ ì „ëµì  ì ‘ê·¼ í•„ìš”</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
            }

            // 3. ê¸°íšì „ë³„ ìƒí’ˆ ì„±ê³¼ ê¸°ì¤€ ì¸ì‚¬ì´íŠ¸
            if (productsData && Object.keys(productsData).length > 0) {
                // ê° ê¸°íšì „ë³„ ì´ ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸ ê³„ì‚°
                const promotionStats = [];
                for (const [pageLocation, products] of Object.entries(productsData)) {
                    if (products && products.length > 0) {
                        const totalViews = products.reduce((sum, p) => sum + (p.item_view_events || 0), 0);
                        const topProduct = products[0];
                        promotionStats.push({
                            pageLocation,
                            totalViews,
                            topProduct: topProduct.item_name || '',
                            productCount: products.length
                        });
                    }
                }

                if (promotionStats.length > 0) {
                    // ìµœê³  ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸
                    const bestProductViews = promotionStats.reduce((best, stat) => 
                        stat.totalViews > best.totalViews ? stat : best
                    );

                    // ìµœì € ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸
                    const worstProductViews = promotionStats.reduce((worst, stat) => 
                        stat.totalViews < worst.totalViews ? stat : worst
                    );

                    const bestPromoNum = getPromotionNumber(bestProductViews.pageLocation);
                    const bestPromoName = bestPromoNum ? `ê¸°íšì „ #${bestPromoNum}` : '';
                    const bestPromoLink = getPromotionLink(bestPromoName, bestPromoNum);

                    const worstPromoNum = getPromotionNumber(worstProductViews.pageLocation);
                    const worstPromoName = worstPromoNum ? `ê¸°íšì „ #${worstPromoNum}` : '';
                    const worstPromoLink = getPromotionLink(worstPromoName, worstPromoNum);

                    productsInsights = `
                        <div style="margin-bottom: 30px;">
                            <h3 style="color: #1a1a1a; font-size: 1.3em; margin-bottom: 20px; font-weight: 700; padding-bottom: 10px; border-bottom: 2px solid #e5e7eb;">
                                ğŸ›ï¸ ê¸°íšì „ë³„ ìƒí’ˆ ì„±ê³¼ ë¶„ì„
                            </h3>
                            <div class="insight-grid">
                                <div class="insight-card excellent">
                                    <h3>ğŸ” ìš°ìˆ˜ ì‚¬ë¡€ - ë†’ì€ ìƒí’ˆ ê´€ì‹¬ë„</h3>
                                    <ul>
                                        <li><strong>${bestPromoLink}</strong></li>
                                        <li>${bestProductViews.topProduct ? '<span style="color:#667eea;">' + bestProductViews.topProduct + '</span>' : ''}</li>
                                        <li>ì´ ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸: <strong>${bestProductViews.totalViews.toLocaleString()}ê±´</strong></li>
                                        <li>ìƒí’ˆ ê°œìˆ˜: <strong>${bestProductViews.productCount}ê°œ</strong></li>
                                        <li>ì‚¬ìš©ìì˜ ìƒí’ˆ íƒìƒ‰ í™œë™ì´ ê°€ì¥ í™œë°œí•œ ê¸°íšì „</li>
                                        <li>ìƒí’ˆ êµ¬ì„± ë° ë…¸ì¶œ ì „ëµì„ ë‹¤ë¥¸ ê¸°íšì „ì— ì ìš© ê²€í† </li>
                                    </ul>
                                </div>

                                <div class="insight-card alert">
                                    <h3>ğŸ”´ ê°œì„  í•„ìš” - ë‚®ì€ ìƒí’ˆ ê´€ì‹¬ë„</h3>
                                    <ul>
                                        <li><strong>${worstPromoLink}</strong></li>
                                        <li>${worstProductViews.topProduct ? '<span style="color:#667eea;">' + worstProductViews.topProduct + '</span>' : ''}</li>
                                        <li>ì´ ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸: <strong>${worstProductViews.totalViews.toLocaleString()}ê±´</strong></li>
                                        <li>ìƒí’ˆ ê°œìˆ˜: <strong>${worstProductViews.productCount}ê°œ</strong></li>
                                        <li>ìƒí’ˆ íƒìƒ‰ í™œë™ì´ ìƒëŒ€ì ìœ¼ë¡œ ë‚®ìŒ</li>
                                        <li>ìƒí’ˆ ë…¸ì¶œ ë°©ì‹ ë° êµ¬ì„± ê°œì„  í•„ìš”</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }

            // ìµœì¢… HTML ìƒì„±
            insightsContent.innerHTML = scrollDepthInsights + performanceInsights + productsInsights;
            
            if (!scrollDepthInsights && !performanceInsights && !productsInsights) {
                insightsContent.innerHTML = '<p style="color:#999; text-align:center; padding:40px;">ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
        }

        function renderTable(scrollDepthData, brand) {
            const tbody = document.getElementById(`scrollDepthTableBody${brand}`);
            
            if (!scrollDepthData || scrollDepthData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" style="text-align:center; padding:40px; color:#999;">ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }
            
            tbody.innerHTML = scrollDepthData.map((item, index) => {
                const total = item.total_events || 0;
                const depth25Rate = total > 0 ? (item.depth_25 / total * 100).toFixed(1) : 0;
                const depth50Rate = total > 0 ? (item.depth_50 / total * 100).toFixed(1) : 0;
                const depth75Rate = total > 0 ? (item.depth_75 / total * 100).toFixed(1) : 0;
                const depth95Rate = total > 0 ? (item.depth_95 / total * 100).toFixed(1) : 0;
                
                // í˜ì´ì§€ ì œëª©ì—ì„œ ë¸Œëœë“œë³„ ì ‘ë‘ì‚¬ ì œê±°
                const shortTitle = getShortTitle(item.page_title || '', brand);
                
                // ê¸°íšì „ ë²ˆí˜¸ ì¶”ì¶œ ë° URL ìƒì„±
                const promotionNumber = item.promotion_number || '';
                let promotionLink = item.promotion_name || '';
                if (promotionNumber) {
                    let baseUrl = '';
                    if (brand === 'X') {
                        baseUrl = `https://www.discovery-expedition.com/display/promotions/collection/${promotionNumber}`;
                    } else if (brand === 'M') {
                        baseUrl = `https://www.mlb-korea.com/display/promotions/collection/${promotionNumber}`;
                    } else if (brand === 'V') {
                        baseUrl = `https://www.duvetica.co.kr/display/archive/collection/${promotionNumber}`;
                    }
                    if (baseUrl) {
                        promotionLink = `<a href="${baseUrl}" target="_blank" style="color:#667eea; text-decoration:underline;">${item.promotion_name}</a>`;
                    }
                }
                
                return `
                    <tr>
                        <td><strong>#${index + 1}</strong></td>
                        <td style="max-width: 300px;">
                            <strong>${promotionLink}</strong><br>
                            <span style="font-size:0.9em; color:#6b7280; line-height:1.4;" title="${item.page_title || ''}">
                                ${shortTitle}
                            </span>
                        </td>
                        <td>${item.page_views.toLocaleString()}</td>
                        <td>${item.depth_25.toLocaleString()}<br><span style="color:#999; font-size:0.9em;">(${depth25Rate}%)</span></td>
                        <td>${item.depth_50.toLocaleString()}<br><span style="color:#999; font-size:0.9em;">(${depth50Rate}%)</span></td>
                        <td>${item.depth_75.toLocaleString()}<br><span style="color:#999; font-size:0.9em;">(${depth75Rate}%)</span></td>
                        <td>${item.depth_95.toLocaleString()}<br><span style="color:#999; font-size:0.9em;">(${depth95Rate}%)</span></td>
                        <td><strong>${total.toLocaleString()}</strong></td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${depth95Rate}%"></div>
                            </div>
                            <span style="font-size:0.9em; color:#667eea;">${depth95Rate}%</span>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function renderChart(scrollDepthData, brand) {
            const ctx = document.getElementById(`scrollDepthChart${brand}`);
            if (!ctx) return;
            
            // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì œê±°
            if (brand === 'X' && chartX) {
                chartX.destroy();
            } else if (brand === 'M' && chartM) {
                chartM.destroy();
            } else if (brand === 'V' && chartV) {
                chartV.destroy();
            } else if (brand === 'ST' && chartST) {
                chartST.destroy();
            }
            
            if (!scrollDepthData || scrollDepthData.length === 0) {
                return;
            }
            
            const chartCtx = ctx.getContext('2d');
            const promotionNumbers = scrollDepthData.map(item => item.promotion_name);
            const depth25Data = scrollDepthData.map(item => item.depth_25);
            const depth50Data = scrollDepthData.map(item => item.depth_50);
            const depth75Data = scrollDepthData.map(item => item.depth_75);
            const depth95Data = scrollDepthData.map(item => item.depth_95);
            
            const newChart = new Chart(chartCtx, {
                type: 'bar',
                data: {
                    labels: promotionNumbers,
                    datasets: [
                        {
                            label: '25% ë„ë‹¬',
                            data: depth25Data,
                            backgroundColor: 'rgba(102, 126, 234, 0.6)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '50% ë„ë‹¬',
                            data: depth50Data,
                            backgroundColor: 'rgba(118, 75, 162, 0.6)',
                            borderColor: 'rgba(118, 75, 162, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '75% ë„ë‹¬',
                            data: depth75Data,
                            backgroundColor: 'rgba(237, 100, 166, 0.6)',
                            borderColor: 'rgba(237, 100, 166, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '95% ë„ë‹¬',
                            data: depth95Data,
                            backgroundColor: 'rgba(255, 159, 64, 0.6)',
                            borderColor: 'rgba(255, 159, 64, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'ê¸°íšì „ë³„ ìŠ¤í¬ë¡¤ ëìŠ¤ ë„ë‹¬ ìˆ˜'
                        }
                    }
                }
            });
            
            // ì°¨íŠ¸ ê°ì²´ ì €ì¥
            if (brand === 'X') {
                chartX = newChart;
            } else if (brand === 'M') {
                chartM = newChart;
            } else if (brand === 'V') {
                chartV = newChart;
            } else if (brand === 'ST') {
                chartST = newChart;
            }
        }

        function renderPerformanceTable(performanceData, brand) {
            const tbody = document.getElementById(`performanceTableBody${brand}`);
            
            if (!performanceData || performanceData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:40px; color:#999;">ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }
            
            // page_locationì—ì„œ ê¸°íšì „ ë²ˆí˜¸ ì¶”ì¶œ í•¨ìˆ˜
            const getPromotionNumber = (pageLocation) => {
                if (!pageLocation) return '';
                const match = pageLocation.match(/\/collection\/(\d+)/);
                return match ? match[1] : '';
            };
            
            tbody.innerHTML = performanceData.map((item, index) => {
                // í˜ì´ì§€ ì œëª©ì—ì„œ ë¸Œëœë“œë³„ ì ‘ë‘ì‚¬ ì œê±°
                const shortTitle = getShortTitle(item.page_title || '', brand);
                // page_locationì—ì„œ ê¸°íšì „ ë²ˆí˜¸ ì¶”ì¶œ
                const promotionNumber = getPromotionNumber(item.page_location || '');
                const promotionName = promotionNumber ? `ê¸°íšì „ #${promotionNumber}` : '';
                const promotionLink = item.page_location && promotionNumber ? 
                    `<a href="${item.page_location}" target="_blank" style="color:#667eea; text-decoration:underline;">${promotionName}</a>` : 
                    promotionName;
                
                // X, M, V ë¸Œëœë“œì¸ ê²½ìš° í† ê¸€ ë²„íŠ¼ ì¶”ê°€
                const toggleButton = (brand === 'X' || brand === 'M' || brand === 'V') && promotionNumber ? 
                    ` <button class="toggle-products-btn" onclick="toggleProducts('${item.page_location || ''}', '${brand}')" style="margin-left:8px; padding:4px 12px; background:#667eea; color:white; border:none; border-radius:4px; cursor:pointer; font-size:0.85em;">
                        ìƒí’ˆ ë³´ê¸°
                    </button>` : '';
                
                // ìˆ«ì í¬ë§·íŒ… (ì²œ ë‹¨ìœ„ êµ¬ë¶„)
                const formatNumber = (num) => {
                    if (num === null || num === undefined) return '0';
                    return typeof num === 'number' ? num.toLocaleString() : num;
                };
                
                // ë§¤ì¶œ í¬ë§·íŒ… (ì› ë‹¨ìœ„)
                const formatRevenue = (revenue) => {
                    if (revenue === null || revenue === undefined || revenue === 0) return 'â‚©0';
                    return `â‚©${formatNumber(Math.round(revenue))}`;
                };
                
                // êµ¬ë§¤ ì „í™˜ìœ¨ ê³„ì‚° ë° í¬ë§·íŒ… (êµ¬ë§¤ ì´ë²¤íŠ¸ / ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸ * 100)
                const formatConversionRate = (itemViewEvents, purchaseEvents) => {
                    if (!itemViewEvents || itemViewEvents === 0) return '<span style="color:#999;">-</span>';
                    const rate = (purchaseEvents / itemViewEvents) * 100;
                    return `<span style="font-weight:600; color:#667eea;">${rate.toFixed(2)}%</span>`;
                };
                
                return `
                    <tr>
                        <td><strong>#${index + 1}</strong></td>
                        <td style="max-width: 300px;">
                            <strong>${promotionLink}</strong>${toggleButton}<br>
                            <span style="font-size:0.9em; color:#6b7280; line-height:1.4;" title="${item.page_title || ''}">
                                ${shortTitle}
                            </span>
                        </td>
                        <td style="font-weight:600; font-size:1.05em;">${formatNumber(item.page_views)}</td>
                        <td style="font-weight:600; font-size:1.05em;">${formatNumber(item.item_view_events || 0)}</td>
                        <td style="font-weight:600; font-size:1.05em;">${formatNumber(item.purchase_events)}</td>
                        <td style="font-size:1.05em;">${formatConversionRate(item.item_view_events || 0, item.purchase_events || 0)}</td>
                        <td style="font-weight:600; font-size:1.05em; color:#1a1a1a;">${formatRevenue(item.revenue)}</td>
                    </tr>
                `;
            }).join('');
        }

        function renderProductsPerformance(productsData, brand) {
            if (brand !== 'X' && brand !== 'M' && brand !== 'V') return;
            
            const container = document.getElementById(`productsPerformanceContainer${brand}`);
            if (!container) return;
            
            if (!productsData || Object.keys(productsData).length === 0) {
                container.innerHTML = '<p style="text-align:center; padding:20px; color:#999;">ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            let html = '';
            for (const [pageLocation, products] of Object.entries(productsData)) {
                if (!products || products.length === 0) continue;
                
                // page_locationì—ì„œ ê¸°íšì „ ë²ˆí˜¸ ì¶”ì¶œ
                const match = pageLocation.match(/\/collection\/(\d+)/);
                const promotionNumber = match ? match[1] : '';
                const promotionName = promotionNumber ? `ê¸°íšì „ #${promotionNumber}` : '';
                
                // page_locationì„ ì•ˆì „í•œ IDë¡œ ë³€í™˜ (ë¸Œëœë“œ í¬í•¨)
                const safeId = `${brand}_${pageLocation.replace(/[^a-zA-Z0-9]/g, '_')}`;
                
                html += `
                    <div id="products-${safeId}" class="products-section" style="display:none; margin-top:30px; padding:20px; background:#f9fafb; border-radius:8px; border:1px solid #e5e7eb;">
                        <h3 style="margin-top:0; margin-bottom:20px; color:#1f2937; font-size:1.2em;">
                            ${promotionName} - ìƒí’ˆ ì¡°íšŒ ì´ë²¤íŠ¸ TOP 5
                        </h3>
                        <table style="width:100%; border-collapse:collapse;">
                            <thead>
                                <tr style="background:#f3f4f6; border-bottom:2px solid #e5e7eb;">
                                    <th style="padding:12px; text-align:left; font-weight:600; color:#374151;">ìˆœìœ„</th>
                                    <th style="padding:12px; text-align:left; font-weight:600; color:#374151;">ìƒí’ˆ ID</th>
                                    <th style="padding:12px; text-align:left; font-weight:600; color:#374151;">ìƒí’ˆëª…</th>
                                    <th style="padding:12px; text-align:right; font-weight:600; color:#374151;">ìƒí’ˆ ì¡°íšŒìˆ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${products.map((product, idx) => {
                                    const formatNumber = (num) => {
                                        if (num === null || num === undefined) return '0';
                                        return typeof num === 'number' ? num.toLocaleString() : num;
                                    };
                                    return `
                                        <tr style="border-bottom:1px solid #e5e7eb;">
                                            <td style="padding:12px; color:#6b7280;"><strong>#${product.rank || idx + 1}</strong></td>
                                            <td style="padding:12px; color:#1f2937; font-family:monospace;">${product.item_id || '-'}</td>
                                            <td style="padding:12px; color:#1f2937;">${product.item_name || '-'}</td>
                                            <td style="padding:12px; text-align:right; font-weight:600; color:#374151;">${formatNumber(product.item_view_events)}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        function toggleProducts(pageLocation, brand) {
            if (!pageLocation || !brand) return;
            
            const safeId = `${brand}_${pageLocation.replace(/[^a-zA-Z0-9]/g, '_')}`;
            const productsSection = document.getElementById(`products-${safeId}`);
            if (!productsSection) return;
            
            const isVisible = productsSection.style.display !== 'none';
            productsSection.style.display = isVisible ? 'none' : 'block';
            
            // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
            const buttons = document.querySelectorAll(`.toggle-products-btn`);
            buttons.forEach(btn => {
                if (btn.onclick && btn.onclick.toString().includes(`'${pageLocation}'`)) {
                    btn.textContent = isVisible ? 'ìƒí’ˆ ë³´ê¸°' : 'ìƒí’ˆ ìˆ¨ê¸°ê¸°';
                }
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë Œë”ë§
        // X ë¸Œëœë“œ (ë””ìŠ¤ì»¤ë²„ë¦¬) ë Œë”ë§
        renderInsights(scrollDepthDataX, 'X', performanceDataX, productsDataX);
        renderTable(scrollDepthDataX, 'X');
        renderChart(scrollDepthDataX, 'X');
        renderPerformanceTable(performanceDataX, 'X');
        renderProductsPerformance(productsDataX, 'X');
        
        // M ë¸Œëœë“œ (MLB) ë Œë”ë§
        renderInsights(scrollDepthDataM, 'M', performanceDataM, productsDataM);
        renderTable(scrollDepthDataM, 'M');
        renderChart(scrollDepthDataM, 'M');
        renderPerformanceTable(performanceDataM, 'M');
        renderProductsPerformance(productsDataM, 'M');
        
        // V ë¸Œëœë“œ (ë“€ë² í‹°ì¹´) ë Œë”ë§
        renderInsights(scrollDepthDataV, 'V', performanceDataV, productsDataV);
        renderTable(scrollDepthDataV, 'V');
        renderChart(scrollDepthDataV, 'V');
        renderPerformanceTable(performanceDataV, 'V');
        renderProductsPerformance(productsDataV, 'V');
        
        // ST ë¸Œëœë“œ ë Œë”ë§
        renderInsights(scrollDepthDataST, 'ST', performanceDataST, null);
        renderTable(scrollDepthDataST, 'ST');
        renderChart(scrollDepthDataST, 'ST');
        renderPerformanceTable(performanceDataST, 'ST');
    </script>
</body>
</html>